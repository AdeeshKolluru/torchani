

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>TorchANI &mdash; TorchANI 0.2.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Structure minimization and constant temperature MD using ASE interface" href="examples/ase_interface.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> TorchANI
          

          
          </a>

          
            
            
              <div class="version">
                0.2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="start.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/energy_force.html">Computing Energy and Force Using Builtin Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/nnp_training.html">Train Your Own Neural Network Potential</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/cache_aev.html">Use Disk Cache of AEV to Boost Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/neurochem_trainer.html">Train Neural Network Potential From NeuroChem Input File</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/ase_interface.html">Structure minimization and constant temperature MD using ASE interface</a></li>
</ul>
<p class="caption"><span class="caption-text">TorchANI's API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">TorchANI</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-torchani.data">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-torchani.utils">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-torchani.neurochem">NeuroChem</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-torchani.ase">ASE Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-torchani.ignite">Ignite Helpers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TorchANI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>TorchANI</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="torchani">
<h1>TorchANI<a class="headerlink" href="#torchani" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="torchani.AEVComputer">
<em class="property">class </em><code class="descclassname">torchani.</code><code class="descname">AEVComputer</code><span class="sig-paren">(</span><em>Rcr</em>, <em>Rca</em>, <em>EtaR</em>, <em>ShfR</em>, <em>EtaA</em>, <em>Zeta</em>, <em>ShfA</em>, <em>ShfZ</em>, <em>num_species</em>, <em>neighborlist_computer=&lt;function default_neighborlist&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/aev.html#AEVComputer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.AEVComputer" title="Permalink to this definition">¶</a></dt>
<dd><p>The AEV computer that takes coordinates as input and outputs aevs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>Rcr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(R_C\)</span> in equation (2) when used at equation (3)
in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>Rca</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – <span class="math notranslate nohighlight">\(R_C\)</span> in equation (2) when used at equation (4)
in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>EtaR</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – The 1D tensor of <span class="math notranslate nohighlight">\(\eta\)</span> in
equation (3) in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>ShfR</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – The 1D tensor of <span class="math notranslate nohighlight">\(R_s\)</span> in
equation (3) in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>EtaA</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – The 1D tensor of <span class="math notranslate nohighlight">\(\eta\)</span> in
equation (4) in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>Zeta</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – The 1D tensor of <span class="math notranslate nohighlight">\(\zeta\)</span> in
equation (4) in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>ShfA</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – The 1D tensor of <span class="math notranslate nohighlight">\(R_s\)</span> in
equation (4) in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>ShfZ</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – The 1D tensor of <span class="math notranslate nohighlight">\(\theta_s\)</span> in
equation (4) in the <a class="reference external" href="http://pubs.rsc.org/en/Content/ArticleLanding/2017/SC/C6SC05720A#!divAbstract">ANI paper</a>.</li>
<li><strong>num_species</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of supported atom types.</li>
<li><strong>neighborlist_computer</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Callable</span></code></a>) – initial
value of <a class="reference internal" href="#torchani.AEVComputer.neighborlist" title="torchani.AEVComputer.neighborlist"><code class="xref py py-attr docutils literal notranslate"><span class="pre">neighborlist</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="torchani.AEVComputer.neighborlist">
<code class="descname">neighborlist</code><a class="headerlink" href="#torchani.AEVComputer.neighborlist" title="Permalink to this definition">¶</a></dt>
<dd><p>The callable
(species:Tensor, coordinates:Tensor, cutoff:float)
-&gt; Tuple[Tensor, Tensor, Tensor] that returns the species,
distances and relative coordinates of neighbor atoms. The input
species and coordinates tensor have the same shape convention as
the input of <a class="reference internal" href="#torchani.AEVComputer" title="torchani.AEVComputer"><code class="xref py py-class docutils literal notranslate"><span class="pre">AEVComputer</span></code></a>. The returned neighbor
species and coordinates tensor must have shape <code class="docutils literal notranslate"><span class="pre">(C,</span> <span class="pre">A,</span> <span class="pre">N)</span></code> and
<code class="docutils literal notranslate"><span class="pre">(C,</span> <span class="pre">A,</span> <span class="pre">N,</span> <span class="pre">3)</span></code> correspoindingly, where <code class="docutils literal notranslate"><span class="pre">C</span></code> is the number of
conformations in a chunk, <code class="docutils literal notranslate"><span class="pre">A</span></code> is the number of atoms, and <code class="docutils literal notranslate"><span class="pre">N</span></code>
is the maximum number of neighbors that an atom could have.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Callable</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torchani.AEVComputer.aev_length">
<code class="descname">aev_length</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/aev.html#AEVComputer.aev_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.AEVComputer.aev_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the length of full aev</p>
</dd></dl>

<dl class="method">
<dt id="torchani.AEVComputer.angular_length">
<code class="descname">angular_length</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/aev.html#AEVComputer.angular_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.AEVComputer.angular_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the length of full angular aev</p>
</dd></dl>

<dl class="method">
<dt id="torchani.AEVComputer.angular_sublength">
<code class="descname">angular_sublength</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/aev.html#AEVComputer.angular_sublength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.AEVComputer.angular_sublength" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the length of angular subaev of a single species</p>
</dd></dl>

<dl class="method">
<dt id="torchani.AEVComputer.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>species_coordinates</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/aev.html#AEVComputer.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.AEVComputer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute AEVs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>species_coordinates</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a>) – Two tensors: species and coordinates.
species must have shape <code class="docutils literal notranslate"><span class="pre">(C,</span> <span class="pre">A)</span></code> and coordinates must have
shape <code class="docutils literal notranslate"><span class="pre">(C,</span> <span class="pre">A,</span> <span class="pre">3)</span></code>, where <code class="docutils literal notranslate"><span class="pre">C</span></code> is the number of conformations
in a chunk, and <code class="docutils literal notranslate"><span class="pre">A</span></code> is the number of atoms.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Species and AEVs. species are the species from the input
unchanged, and AEVs is a tensor of shape
<code class="docutils literal notranslate"><span class="pre">(C,</span> <span class="pre">A,</span> <span class="pre">self.aev_length())</span></code></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torchani.AEVComputer.radial_length">
<code class="descname">radial_length</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/aev.html#AEVComputer.radial_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.AEVComputer.radial_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the length of full radial aev</p>
</dd></dl>

<dl class="method">
<dt id="torchani.AEVComputer.radial_sublength">
<code class="descname">radial_sublength</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/aev.html#AEVComputer.radial_sublength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.AEVComputer.radial_sublength" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the length of radial subaev of a single species</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="torchani.ANIModel">
<em class="property">class </em><code class="descclassname">torchani.</code><code class="descname">ANIModel</code><span class="sig-paren">(</span><em>modules</em>, <em>reducer=&lt;built-in method sum of type object&gt;</em>, <em>padding_fill=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/nn.html#ANIModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.ANIModel" title="Permalink to this definition">¶</a></dt>
<dd><p>ANI model that compute properties from species and AEVs.</p>
<p>Different atom types might have different modules, when computing
properties, for each atom, the module for its corresponding atom type will
be applied to its AEV, after that, outputs of modules will be reduced along
different atoms to obtain molecular properties.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>modules</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a>) – Modules for each atom
types. Atom types are distinguished by their order in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">modules</span></code>, which means, for example <code class="docutils literal notranslate"><span class="pre">modules[i]</span></code> must be
the module for atom type <code class="docutils literal notranslate"><span class="pre">i</span></code>. Different atom types can share a
module by putting the same reference in <code class="xref py py-attr docutils literal notranslate"><span class="pre">modules</span></code>.</li>
<li><strong>reducer</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Callable</span></code></a>) – The callable that reduce
atomic outputs into molecular outputs. It must have signature
<code class="docutils literal notranslate"><span class="pre">(tensor,</span> <span class="pre">dim)-&gt;tensor</span></code>.</li>
<li><strong>padding_fill</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The value to fill output of padding atoms.
Padding values will participate in reducing, so this value should
be appropriately chosen so that it has no effect on the result. For
example, if the reducer is <a class="reference external" href="https://pytorch.org/docs/master/torch.html#torch.sum" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.sum()</span></code></a>, then
<code class="xref py py-attr docutils literal notranslate"><span class="pre">padding_fill</span></code> should be 0, and if the reducer is
<a class="reference external" href="https://pytorch.org/docs/master/torch.html#torch.min" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.min()</span></code></a>, then <code class="xref py py-attr docutils literal notranslate"><span class="pre">padding_fill</span></code> should be
<a class="reference external" href="https://docs.python.org/3/library/math.html#math.inf" title="(in Python v3.7)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">math.inf</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="torchani.Ensemble">
<em class="property">class </em><code class="descclassname">torchani.</code><code class="descname">Ensemble</code><span class="sig-paren">(</span><em>modules=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/nn.html#Ensemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.Ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the average output of an ensemble of modules.</p>
</dd></dl>

<dl class="class">
<dt id="torchani.EnergyShifter">
<em class="property">class </em><code class="descclassname">torchani.</code><code class="descname">EnergyShifter</code><span class="sig-paren">(</span><em>self_energies</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#EnergyShifter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.EnergyShifter" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper class for adding and subtracting self atomic energies</p>
<p>This is a subclass of <a class="reference external" href="https://pytorch.org/docs/master/nn.html#torch.nn.Module" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a>, so it can be used directly
in a pipeline as <code class="docutils literal notranslate"><span class="pre">[input-&gt;AEVComputer-&gt;ANIModel-&gt;EnergyShifter-&gt;output]</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>self_energies</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a>) – Sequence of floating
numbers for the self energy of each atom type. The numbers should
be in order, i.e. <code class="docutils literal notranslate"><span class="pre">self_energies[i]</span></code> should be atom type <code class="docutils literal notranslate"><span class="pre">i</span></code>.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torchani.EnergyShifter.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>species_energies</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#EnergyShifter.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.EnergyShifter.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>(species, molecular energies)-&gt;(species, molecular energies + sae)</p>
</dd></dl>

<dl class="method">
<dt id="torchani.EnergyShifter.sae">
<code class="descname">sae</code><span class="sig-paren">(</span><em>species</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#EnergyShifter.sae"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.EnergyShifter.sae" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute self energies for molecules.</p>
<p>Padding atoms will be automatically excluded.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>species</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – Long tensor in shape
<code class="docutils literal notranslate"><span class="pre">(conformations,</span> <span class="pre">atoms)</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">1D vector in shape <code class="docutils literal notranslate"><span class="pre">(conformations,)</span></code>
for molecular self energies.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="torchani.EnergyShifter.subtract_from_dataset">
<code class="descname">subtract_from_dataset</code><span class="sig-paren">(</span><em>species</em>, <em>coordinates</em>, <em>properties</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#EnergyShifter.subtract_from_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.EnergyShifter.subtract_from_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Transformer for <a class="reference internal" href="#torchani.data.BatchedANIDataset" title="torchani.data.BatchedANIDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.data.BatchedANIDataset</span></code></a> that
subtract self energies.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="torchani.nn.Gaussian">
<em class="property">class </em><code class="descclassname">torchani.nn.</code><code class="descname">Gaussian</code><a class="reference internal" href="_modules/torchani/nn.html#Gaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.nn.Gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaussian activation</p>
</dd></dl>

</div>
<div class="section" id="module-torchani.data">
<span id="datasets"></span><h1>Datasets<a class="headerlink" href="#module-torchani.data" title="Permalink to this headline">¶</a></h1>
<p>Tools for loading, shuffling, and batching ANI datasets</p>
<dl class="class">
<dt id="torchani.data.BatchedANIDataset">
<em class="property">class </em><code class="descclassname">torchani.data.</code><code class="descname">BatchedANIDataset</code><span class="sig-paren">(</span><em>path, species_tensor_converter, batch_size, shuffle=True, properties=['energies'], transform=(), dtype=torch.float32, device='cpu'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/data.html#BatchedANIDataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.data.BatchedANIDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Load data from hdf5 files, create minibatches, and convert to tensors.</p>
<p>This is already a dataset of batches, so when iterated, a batch rather
than a single data point will be yielded.</p>
<p>Since each batch might contain molecules of very different sizes, putting
the whole batch into a single tensor would require adding ghost atoms to
pad everything to the size of the largest molecule. As a result, huge
amount of computation would be wasted on ghost atoms. To avoid this issue,
the input of each batch, i.e. species and coordinates, are further divided
into chunks according to some heuristics, so that each chunk would only
have molecules of similar size, to minimize the padding required.</p>
<p>So, when iterating on this dataset, a tuple will be yielded. The first
element of this tuple is a list of (species, coordinates) pairs. Each pair
is a chunk of molecules of similar size. The second element of this tuple
would be a dictionary, where the keys are those specified in the argument
<code class="xref py py-attr docutils literal notranslate"><span class="pre">properties</span></code>, and values are a single tensor of the whole batch
(properties are not splitted into chunks).</p>
<p>Splitting batch into chunks leads to some inconvenience on training,
especially when using high level libraries like <code class="docutils literal notranslate"><span class="pre">ignite</span></code>. To overcome
this inconvenience, <a class="reference internal" href="#torchani.ignite.Container" title="torchani.ignite.Container"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.ignite.Container</span></code></a> is created for
working with ignite.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Path to hdf5 files. If <code class="xref py py-attr docutils literal notranslate"><span class="pre">path</span></code> is a file, then that
file would be loaded using <a class="reference external" href="https://github.com/isayev/ASE_ANI/blob/master/lib/pyanitools.py">pyanitools.py</a>. If <code class="xref py py-attr docutils literal notranslate"><span class="pre">path</span></code> is
a directory, then all files with suffix <cite>.h5</cite> or <cite>.hdf5</cite> will be
loaded.</li>
<li><strong>species_tensor_converter</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Callable</span></code></a>) – A
callable that convert species in the format of list of strings
to 1D tensor.</li>
<li><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of different 3D structures in a single
minibatch.</li>
<li><strong>shuffle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Whether to shuffle the whole dataset.</li>
<li><strong>properties</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – List of keys in the dataset to be loaded.
<code class="docutils literal notranslate"><span class="pre">'species'</span></code> and <code class="docutils literal notranslate"><span class="pre">'coordinates'</span></code> are always loaded and need not
to be specified here.</li>
<li><strong>transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – List of <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Callable</span></code></a> that
transform the data. Callables must take species, coordinates,
and properties of the whole dataset as arguments, and return
the transformed species, coordinates, and properties.</li>
<li><strong>dtype</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.dtype</span></code>) – dtype of coordinates and properties to
to convert the dataset to.</li>
<li><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.dtype</span></code>) – device to put tensors when iterating.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="torchani.data.AEVCacheLoader">
<em class="property">class </em><code class="descclassname">torchani.data.</code><code class="descname">AEVCacheLoader</code><span class="sig-paren">(</span><em>disk_cache=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/data.html#AEVCacheLoader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.data.AEVCacheLoader" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a factory for AEV.</p>
<p>The computation of AEV is the most time consuming part during training.
Since during training, the AEV never changes, it is not hard to see that,
If we have a fast enough storage (this is usually the case for good SSDs,
but not for HDD), we could cache the computed AEVs into disk and load it
rather than compute it from scratch everytime we use it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>disk_cache</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Directory storing disk caches.</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-torchani.data.cache_aev"></span><p>AEVs for a dataset can be precomputed by invoking
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">torchani.data.cache_aev</span></code>, this would dump the dataset and
computed aevs. Use the <code class="docutils literal notranslate"><span class="pre">-h</span></code> option for help.</p>
</div>
<div class="section" id="module-torchani.utils">
<span id="utilities"></span><h1>Utilities<a class="headerlink" href="#module-torchani.utils" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="torchani.utils.pad">
<code class="descclassname">torchani.utils.</code><code class="descname">pad</code><span class="sig-paren">(</span><em>species</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#pad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.utils.pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Put different species together into single tensor.</p>
<p>If the species are from molecules of different number of total atoms, then
ghost atoms with atom type -1 will be added to make it fit into the same
shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a>) – sequence of species.
Species must be of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">A)</span></code>, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of
3D structures, <code class="docutils literal notranslate"><span class="pre">A</span></code> is the number of atoms.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">species batched together.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torchani.utils.pad_coordinates">
<code class="descclassname">torchani.utils.</code><code class="descname">pad_coordinates</code><span class="sig-paren">(</span><em>species_coordinates</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#pad_coordinates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.utils.pad_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Put different species and coordinates together into single tensor.</p>
<p>If the species and coordinates are from molecules of different number of
total atoms, then ghost atoms with atom type -1 and coordinate (0, 0, 0)
will be added to make it fit into the same shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>species_coordinates</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a>) – sequence of
pairs of species and coordinates. Species must be of shape
<code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">A)</span></code> and coordinates must be of shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">A,</span> <span class="pre">3)</span></code>, where
<code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of 3D structures, <code class="docutils literal notranslate"><span class="pre">A</span></code> is the number of atoms.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Species, and
coordinates batched together.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>, <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torchani.utils.present_species">
<code class="descclassname">torchani.utils.</code><code class="descname">present_species</code><span class="sig-paren">(</span><em>species</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#present_species"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.utils.present_species" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a vector of species of atoms, compute the unique species present.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>species</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – 1D vector of shape <code class="docutils literal notranslate"><span class="pre">(atoms,)</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">1D vector storing present atom types sorted.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torchani.utils.strip_redundant_padding">
<code class="descclassname">torchani.utils.</code><code class="descname">strip_redundant_padding</code><span class="sig-paren">(</span><em>species</em>, <em>coordinates</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#strip_redundant_padding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.utils.strip_redundant_padding" title="Permalink to this definition">¶</a></dt>
<dd><p>Strip trailing padding atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>species</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – Long tensor of shape
<code class="docutils literal notranslate"><span class="pre">(conformations,</span> <span class="pre">atoms)</span></code>.</li>
<li><strong>coordinates</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>) – Tensor of shape
<code class="docutils literal notranslate"><span class="pre">(conformations,</span> <span class="pre">atoms,</span> <span class="pre">3)</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">species and coordinates
with redundant padding atoms stripped.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>, <a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="torchani.utils.ChemicalSymbolsToInts">
<em class="property">class </em><code class="descclassname">torchani.utils.</code><code class="descname">ChemicalSymbolsToInts</code><span class="sig-paren">(</span><em>all_species</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/utils.html#ChemicalSymbolsToInts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.utils.ChemicalSymbolsToInts" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper that can be called to convert chemical symbol string to integers</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>all_species</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – sequence of all supported species, in order.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-torchani.neurochem">
<span id="neurochem"></span><h1>NeuroChem<a class="headerlink" href="#module-torchani.neurochem" title="Permalink to this headline">¶</a></h1>
<p>Tools for loading/running NeuroChem input files.</p>
<dl class="class">
<dt id="torchani.neurochem.Constants">
<em class="property">class </em><code class="descclassname">torchani.neurochem.</code><code class="descname">Constants</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#Constants"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.neurochem.Constants" title="Permalink to this definition">¶</a></dt>
<dd><p>NeuroChem constants. Objects of this class can be used as arguments
to <a class="reference internal" href="#torchani.AEVComputer" title="torchani.AEVComputer"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.AEVComputer</span></code></a>, like <code class="docutils literal notranslate"><span class="pre">torchani.AEVComputer(**consts)</span></code>.</p>
<dl class="attribute">
<dt id="torchani.neurochem.Constants.species_to_tensor">
<code class="descname">species_to_tensor</code><a class="headerlink" href="#torchani.neurochem.Constants.species_to_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>call to convert
string chemical symbols to 1d long tensor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChemicalSymbolsToInts</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="torchani.neurochem.load_sae">
<code class="descclassname">torchani.neurochem.</code><code class="descname">load_sae</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#load_sae"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.neurochem.load_sae" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an object of <code class="xref py py-class docutils literal notranslate"><span class="pre">EnergyShifter</span></code> with self energies from
NeuroChem sae file</p>
</dd></dl>

<dl class="function">
<dt id="torchani.neurochem.load_atomic_network">
<code class="descclassname">torchani.neurochem.</code><code class="descname">load_atomic_network</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#load_atomic_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.neurochem.load_atomic_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an instance of <a class="reference external" href="https://pytorch.org/docs/master/nn.html#torch.nn.Sequential" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Sequential</span></code></a> with hyperparameters
and parameters loaded NeuroChem’s .nnf, .wparam and .bparam files.</p>
</dd></dl>

<dl class="function">
<dt id="torchani.neurochem.load_model">
<code class="descclassname">torchani.neurochem.</code><code class="descname">load_model</code><span class="sig-paren">(</span><em>species</em>, <em>dir_</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.neurochem.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an instance of <a class="reference internal" href="#torchani.ANIModel" title="torchani.ANIModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.ANIModel</span></code></a> loaded from
NeuroChem’s network directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a>) – Sequence of strings for
chemical symbols of each supported atom type in correct order.</li>
<li><strong>dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – String for directory storing network configurations.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="torchani.neurochem.load_model_ensemble">
<code class="descclassname">torchani.neurochem.</code><code class="descname">load_model_ensemble</code><span class="sig-paren">(</span><em>species</em>, <em>prefix</em>, <em>count</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#load_model_ensemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.neurochem.load_model_ensemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an instance of <a class="reference internal" href="#torchani.Ensemble" title="torchani.Ensemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.Ensemble</span></code></a> loaded from
NeuroChem’s network directories beginning with the given prefix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a>) – Sequence of strings for
chemical symbols of each supported atom type in correct order.</li>
<li><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Prefix of paths of directory that networks configurations
are stored.</li>
<li><strong>count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of models in the ensemble.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="torchani.neurochem.Builtins">
<em class="property">class </em><code class="descclassname">torchani.neurochem.</code><code class="descname">Builtins</code><a class="reference internal" href="_modules/torchani/neurochem.html#Builtins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.neurochem.Builtins" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for all builtin stuffs.</p>
<dl class="attribute">
<dt id="torchani.neurochem.Builtins.const_file">
<code class="descname">const_file</code><a class="headerlink" href="#torchani.neurochem.Builtins.const_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to the builtin constant file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="torchani.neurochem.Builtins.consts">
<code class="descname">consts</code><a class="headerlink" href="#torchani.neurochem.Builtins.consts" title="Permalink to this definition">¶</a></dt>
<dd><p>Constants loaded from builtin constant
file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="#torchani.neurochem.Constants" title="torchani.neurochem.Constants"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constants</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="torchani.neurochem.Builtins.aev_computer">
<code class="descname">aev_computer</code><a class="headerlink" href="#torchani.neurochem.Builtins.aev_computer" title="Permalink to this definition">¶</a></dt>
<dd><p>AEV computer with builtin
constants.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="#torchani.AEVComputer" title="torchani.AEVComputer"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.AEVComputer</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="torchani.neurochem.Builtins.sae_file">
<code class="descname">sae_file</code><a class="headerlink" href="#torchani.neurochem.Builtins.sae_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to the builtin self atomic energy file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="torchani.neurochem.Builtins.energy_shifter">
<code class="descname">energy_shifter</code><a class="headerlink" href="#torchani.neurochem.Builtins.energy_shifter" title="Permalink to this definition">¶</a></dt>
<dd><p>AEV computer with
builtin constants.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="#torchani.EnergyShifter" title="torchani.EnergyShifter"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.EnergyShifter</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="torchani.neurochem.Builtins.ensemble_size">
<code class="descname">ensemble_size</code><a class="headerlink" href="#torchani.neurochem.Builtins.ensemble_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of models in model ensemble.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="torchani.neurochem.Builtins.ensemble_prefix">
<code class="descname">ensemble_prefix</code><a class="headerlink" href="#torchani.neurochem.Builtins.ensemble_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Prefix of directories of models.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="torchani.neurochem.Builtins.models">
<code class="descname">models</code><a class="headerlink" href="#torchani.neurochem.Builtins.models" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensemble of models.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="#torchani.Ensemble" title="torchani.Ensemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.Ensemble</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="torchani.neurochem.Trainer">
<em class="property">class </em><code class="descclassname">torchani.neurochem.</code><code class="descname">Trainer</code><span class="sig-paren">(</span><em>filename</em>, <em>device=device(type='cuda')</em>, <em>tqdm=False</em>, <em>tensorboard=None</em>, <em>aev_caching=False</em>, <em>checkpoint_name='model.pt'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#Trainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.neurochem.Trainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Train with NeuroChem training configurations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Input file name</li>
<li><strong>device</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">torch.device</span></code>) – device to train the model</li>
<li><strong>tqdm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – whether to enable tqdm</li>
<li><strong>tensorboard</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Directory to store tensorboard log file, set to
<code class="docutils literal notranslate"><span class="pre">None</span></code> to disable tensorboardX.</li>
<li><strong>aev_caching</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Whether to use AEV caching.</li>
<li><strong>checkpoint_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Name of the checkpoint file, checkpoints will be
stored in the network directory with this file name.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torchani.neurochem.Trainer.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><em>dataset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#Trainer.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.neurochem.Trainer.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate on given dataset to compute RMSE and MAE.</p>
</dd></dl>

<dl class="method">
<dt id="torchani.neurochem.Trainer.load_data">
<code class="descname">load_data</code><span class="sig-paren">(</span><em>training_path</em>, <em>validation_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#Trainer.load_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.neurochem.Trainer.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load training and validation dataset from file.</p>
<p>If AEV caching is enabled, then the arguments are path to the cache
directory, otherwise it should be path to the dataset.</p>
</dd></dl>

<dl class="method">
<dt id="torchani.neurochem.Trainer.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/neurochem.html#Trainer.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.neurochem.Trainer.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the training</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-torchani.neurochem.trainer"></span><p>Besides running NeuroChem trainer by programming, we can also run it by
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">torchani.neurochem.trainer</span></code>, use the <code class="docutils literal notranslate"><span class="pre">-h</span></code> option for help.</p>
</div>
<div class="section" id="module-torchani.ase">
<span id="ase-interface"></span><h1>ASE Interface<a class="headerlink" href="#module-torchani.ase" title="Permalink to this headline">¶</a></h1>
<p>Tools for interfacing with <a class="reference external" href="https://wiki.fysik.dtu.dk/ase">ASE</a>.</p>
<dl class="class">
<dt id="torchani.ase.NeighborList">
<em class="property">class </em><code class="descclassname">torchani.ase.</code><code class="descname">NeighborList</code><span class="sig-paren">(</span><em>cell=None</em>, <em>pbc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/ase.html#NeighborList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.ase.NeighborList" title="Permalink to this definition">¶</a></dt>
<dd><p>ASE neighborlist computer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cell</strong> – same as in <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/atoms.html#ase.Atoms" title="(in ASE)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code></a></li>
<li><strong>pbc</strong> – same as in <a class="reference external" href="https://wiki.fysik.dtu.dk/ase/ase/atoms.html#ase.Atoms" title="(in ASE)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ase.Atoms</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="torchani.ase.Calculator">
<em class="property">class </em><code class="descclassname">torchani.ase.</code><code class="descname">Calculator</code><span class="sig-paren">(</span><em>species</em>, <em>aev_computer</em>, <em>model</em>, <em>energy_shifter</em>, <em>_default_neighborlist=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/ase.html#Calculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.ase.Calculator" title="Permalink to this definition">¶</a></dt>
<dd><p>TorchANI calculator for ASE</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>species</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Sequence</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – sequence of all supported species, in order.</li>
<li><strong>aev_computer</strong> (<a class="reference internal" href="#torchani.AEVComputer" title="torchani.AEVComputer"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.AEVComputer</span></code></a>) – AEV computer.</li>
<li><strong>model</strong> (<a class="reference internal" href="#torchani.ANIModel" title="torchani.ANIModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.ANIModel</span></code></a> or <a class="reference internal" href="#torchani.Ensemble" title="torchani.Ensemble"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.Ensemble</span></code></a>) – neural network potential models.</li>
<li><strong>energy_shifter</strong> (<a class="reference internal" href="#torchani.EnergyShifter" title="torchani.EnergyShifter"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.EnergyShifter</span></code></a>) – Energy shifter.</li>
<li><strong>_default_neighborlist</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Whether to ignore pbc setting and always
use default neighborlist computer. This is for internal use only.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torchani.ase.Calculator.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>atoms=None, properties=['energy'], system_changes=['positions', 'numbers', 'cell', 'pbc', 'initial_charges', 'initial_magmoms']</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/ase.html#Calculator.calculate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.ase.Calculator.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the calculation.</p>
<dl class="docutils">
<dt>properties: list of str</dt>
<dd>List of what needs to be calculated.  Can be any combination
of ‘energy’, ‘forces’, ‘stress’, ‘dipole’, ‘charges’, ‘magmom’
and ‘magmoms’.</dd>
<dt>system_changes: list of str</dt>
<dd>List of what has changed since last calculation.  Can be
any combination of these six: ‘positions’, ‘numbers’, ‘cell’,
‘pbc’, ‘initial_charges’ and ‘initial_magmoms’.</dd>
</dl>
<p>Subclasses need to implement this, but can ignore properties
and system_changes if they want.  Calculated properties should
be inserted into results dictionary like shown in this dummy
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;forces&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">),</span> <span class="mi">3</span><span class="p">)),</span>
                <span class="s1">&#39;stress&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
                <span class="s1">&#39;dipole&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                <span class="s1">&#39;charges&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)),</span>
                <span class="s1">&#39;magmom&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;magmoms&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">))}</span>
</pre></div>
</div>
<p>The subclass implementation should first call this
implementation to set the atoms attribute.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-torchani.ignite">
<span id="ignite-helpers"></span><h1>Ignite Helpers<a class="headerlink" href="#module-torchani.ignite" title="Permalink to this headline">¶</a></h1>
<p>Helpers for working with ignite.</p>
<dl class="class">
<dt id="torchani.ignite.Container">
<em class="property">class </em><code class="descclassname">torchani.ignite.</code><code class="descname">Container</code><span class="sig-paren">(</span><em>modules</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/ignite.html#Container"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.ignite.Container" title="Permalink to this definition">¶</a></dt>
<dd><p>Each minibatch is splitted into chunks, as explained in the docstring of
<a class="reference internal" href="#torchani.data.BatchedANIDataset" title="torchani.data.BatchedANIDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.data.BatchedANIDataset</span></code></a>, as a result, it is impossible to
use <a class="reference internal" href="#torchani.AEVComputer" title="torchani.AEVComputer"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.AEVComputer</span></code></a>, <a class="reference internal" href="#torchani.ANIModel" title="torchani.ANIModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">torchani.ANIModel</span></code></a> directly with
ignite. This class is designed to solve this issue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>modules</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Mapping" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.abc.Mapping</span></code></a>) – same as the argument in
<a class="reference external" href="https://pytorch.org/docs/master/nn.html#torch.nn.ModuleDict" title="(in PyTorch vmaster (1.1.0a0+54c981d ))"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.ModuleDict</span></code></a>.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="torchani.ignite.Container.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>species_x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/ignite.html#Container.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.ignite.Container.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes sequence of species, coordinates pair as input, and returns
computed properties as a dictionary. Same property from different
chunks will be concatenated to form a single tensor for a batch.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="torchani.ignite.DictLoss">
<em class="property">class </em><code class="descclassname">torchani.ignite.</code><code class="descname">DictLoss</code><span class="sig-paren">(</span><em>key</em>, <em>loss</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/ignite.html#DictLoss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.ignite.DictLoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Since <a class="reference internal" href="#torchani.ignite.Container" title="torchani.ignite.Container"><code class="xref py py-class docutils literal notranslate"><span class="pre">Container</span></code></a> output dictionaries, losses defined in
<code class="xref py py-attr docutils literal notranslate"><span class="pre">torch.nn</span></code> needs to be wrapped before used. This class wraps losses
that directly work on tensors with a key by calling the wrapped loss on the
associated value of that key.</p>
</dd></dl>

<dl class="class">
<dt id="torchani.ignite.PerAtomDictLoss">
<em class="property">class </em><code class="descclassname">torchani.ignite.</code><code class="descname">PerAtomDictLoss</code><span class="sig-paren">(</span><em>key</em>, <em>loss</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/ignite.html#PerAtomDictLoss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.ignite.PerAtomDictLoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to <a class="reference internal" href="#torchani.ignite.DictLoss" title="torchani.ignite.DictLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">DictLoss</span></code></a>, but scale the loss values by the number of
atoms for each structure. The <cite>loss</cite> argument must be set to not to reduce
by the caller. Currently the only reduce operation supported is averaging.</p>
</dd></dl>

<dl class="class">
<dt id="torchani.ignite.TransformedLoss">
<em class="property">class </em><code class="descclassname">torchani.ignite.</code><code class="descname">TransformedLoss</code><span class="sig-paren">(</span><em>origin</em>, <em>transform</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/ignite.html#TransformedLoss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.ignite.TransformedLoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Do a transformation on loss values.</p>
</dd></dl>

<dl class="function">
<dt id="torchani.ignite.MSELoss">
<code class="descclassname">torchani.ignite.</code><code class="descname">MSELoss</code><span class="sig-paren">(</span><em>key</em>, <em>per_atom=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/ignite.html#MSELoss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.ignite.MSELoss" title="Permalink to this definition">¶</a></dt>
<dd><p>Create MSE loss on the specified key.</p>
</dd></dl>

<dl class="class">
<dt id="torchani.ignite.DictMetric">
<em class="property">class </em><code class="descclassname">torchani.ignite.</code><code class="descname">DictMetric</code><span class="sig-paren">(</span><em>key</em>, <em>metric</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/ignite.html#DictMetric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.ignite.DictMetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to <a class="reference internal" href="#torchani.ignite.DictLoss" title="torchani.ignite.DictLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">DictLoss</span></code></a>, but this is for metric, not loss.</p>
</dd></dl>

<dl class="function">
<dt id="torchani.ignite.RMSEMetric">
<code class="descclassname">torchani.ignite.</code><code class="descname">RMSEMetric</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/ignite.html#RMSEMetric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.ignite.RMSEMetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Create RMSE metric on key.</p>
</dd></dl>

<dl class="function">
<dt id="torchani.ignite.MAEMetric">
<code class="descclassname">torchani.ignite.</code><code class="descname">MAEMetric</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchani/ignite.html#MAEMetric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#torchani.ignite.MAEMetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Create max absolute error metric on key.</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="examples/ase_interface.html" class="btn btn-neutral" title="Structure minimization and constant temperature MD using ASE interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Roitberg Group

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>