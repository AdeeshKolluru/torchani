

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Train Your Own Neural Network Potential &mdash; TorchANI 0.9 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Train Neural Network Potential To Both Energies and Forces" href="nnp_training_force.html" />
    <link rel="prev" title="Construct Model From NeuroChem Files" href="load_from_neurochem.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> TorchANI
          

          
          </a>

          
            
            
              <div class="version">
                0.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../start.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="energy_force.html">Computing Energy and Force Using Models Inside Model Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="ase_interface.html">Structure minimization and constant temperature MD using ASE interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="vibration_analysis.html">Computing Vibrational Frequencies Using Analytical Hessian</a></li>
<li class="toctree-l1"><a class="reference internal" href="load_from_neurochem.html">Construct Model From NeuroChem Files</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Train Your Own Neural Network Potential</a></li>
<li class="toctree-l1"><a class="reference internal" href="nnp_training_force.html">Train Neural Network Potential To Both Energies and Forces</a></li>
<li class="toctree-l1"><a class="reference internal" href="nnp_training_ignite.html">Train Your Own Neural Network Potential, Using PyTorch-Ignite</a></li>
<li class="toctree-l1"><a class="reference internal" href="cache_aev.html">Use Disk Cache of AEV to Boost Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="neurochem_trainer.html">Train Neural Network Potential From NeuroChem Input File</a></li>
</ul>
<p class="caption"><span class="caption-text">TorchANI's API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">TorchANI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#module-torchani.models">Model Zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#module-torchani.data">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#module-torchani.utils">Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#module-torchani.neurochem">NeuroChem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#module-torchani.ase">ASE Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#module-torchani.optim">TorchANI Optimizater</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#module-torchani.ignite">Ignite Helpers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TorchANI</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Train Your Own Neural Network Potential</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/examples/nnp_training.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-examples-nnp-training-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="train-your-own-neural-network-potential">
<span id="training-example"></span><span id="sphx-glr-examples-nnp-training-py"></span><h1>Train Your Own Neural Network Potential<a class="headerlink" href="#train-your-own-neural-network-potential" title="Permalink to this headline">¶</a></h1>
<p>This example shows how to use TorchANI to train a neural network potential
with the setup identical to NeuroChem. We will use the same configuration as
specified in <a class="reference external" href="https://github.com/aiqm/torchani/blob/master/torchani/resources/ani-1x_8x/inputtrain.ipt">inputtrain.ipt</a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">TorchANI provide tools to run NeuroChem training config file <cite>inputtrain.ipt</cite>.
See: <a class="reference internal" href="neurochem_trainer.html#neurochem-training"><span class="std std-ref">Train Neural Network Potential From NeuroChem Input File</span></a>.</p>
</div>
<p>To begin with, let’s first import the modules and setup devices we will use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torchani</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">torch.utils.tensorboard</span>
<span class="kn">import</span> <span class="nn">tqdm</span>

<span class="c1"># device to run the training</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let’s setup constants and construct an AEV computer. These numbers could
be found in <cite>rHCNO-5.2R_16-3.5A_a4-8.params</cite>
The atomic self energies given in <a class="reference external" href="https://github.com/aiqm/torchani/blob/master/torchani/resources/ani-1x_8x/sae_linfit.dat">sae_linfit.dat</a> are computed from ANI-1x
dataset. These constants can be calculated for any given dataset if <code class="docutils literal notranslate"><span class="pre">None</span></code>
is provided as an argument to the object of <code class="xref py py-class docutils literal notranslate"><span class="pre">EnergyShifter</span></code> class.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Besides defining these hyperparameters programmatically,
<a class="reference internal" href="../api.html#module-torchani.neurochem" title="torchani.neurochem"><code class="xref py py-mod docutils literal notranslate"><span class="pre">torchani.neurochem</span></code></a> provide tools to read them from file. See also
<a class="reference internal" href="nnp_training_ignite.html#training-example-ignite"><span class="std std-ref">Train Your Own Neural Network Potential, Using PyTorch-Ignite</span></a> for an example of usage.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Rcr</span> <span class="o">=</span> <span class="mf">5.2000e+00</span>
<span class="n">Rca</span> <span class="o">=</span> <span class="mf">3.5000e+00</span>
<span class="n">EtaR</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.6000000e+01</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">ShfR</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">9.0000000e-01</span><span class="p">,</span> <span class="mf">1.1687500e+00</span><span class="p">,</span> <span class="mf">1.4375000e+00</span><span class="p">,</span> <span class="mf">1.7062500e+00</span><span class="p">,</span> <span class="mf">1.9750000e+00</span><span class="p">,</span> <span class="mf">2.2437500e+00</span><span class="p">,</span> <span class="mf">2.5125000e+00</span><span class="p">,</span> <span class="mf">2.7812500e+00</span><span class="p">,</span> <span class="mf">3.0500000e+00</span><span class="p">,</span> <span class="mf">3.3187500e+00</span><span class="p">,</span> <span class="mf">3.5875000e+00</span><span class="p">,</span> <span class="mf">3.8562500e+00</span><span class="p">,</span> <span class="mf">4.1250000e+00</span><span class="p">,</span> <span class="mf">4.3937500e+00</span><span class="p">,</span> <span class="mf">4.6625000e+00</span><span class="p">,</span> <span class="mf">4.9312500e+00</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">Zeta</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">3.2000000e+01</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">ShfZ</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.9634954e-01</span><span class="p">,</span> <span class="mf">5.8904862e-01</span><span class="p">,</span> <span class="mf">9.8174770e-01</span><span class="p">,</span> <span class="mf">1.3744468e+00</span><span class="p">,</span> <span class="mf">1.7671459e+00</span><span class="p">,</span> <span class="mf">2.1598449e+00</span><span class="p">,</span> <span class="mf">2.5525440e+00</span><span class="p">,</span> <span class="mf">2.9452431e+00</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">EtaA</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">8.0000000e+00</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">ShfA</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">9.0000000e-01</span><span class="p">,</span> <span class="mf">1.5500000e+00</span><span class="p">,</span> <span class="mf">2.2000000e+00</span><span class="p">,</span> <span class="mf">2.8500000e+00</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">num_species</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">aev_computer</span> <span class="o">=</span> <span class="n">torchani</span><span class="o">.</span><span class="n">AEVComputer</span><span class="p">(</span><span class="n">Rcr</span><span class="p">,</span> <span class="n">Rca</span><span class="p">,</span> <span class="n">EtaR</span><span class="p">,</span> <span class="n">ShfR</span><span class="p">,</span> <span class="n">EtaA</span><span class="p">,</span> <span class="n">Zeta</span><span class="p">,</span> <span class="n">ShfA</span><span class="p">,</span> <span class="n">ShfZ</span><span class="p">,</span> <span class="n">num_species</span><span class="p">)</span>
<span class="n">energy_shifter</span> <span class="o">=</span> <span class="n">torchani</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">EnergyShifter</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">species_to_tensor</span> <span class="o">=</span> <span class="n">torchani</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">ChemicalSymbolsToInts</span><span class="p">(</span><span class="s1">&#39;HCNO&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let’s setup datasets. These paths assumes the user run this script under
the <code class="docutils literal notranslate"><span class="pre">examples</span></code> directory of TorchANI’s repository. If you download this
script, you should manually set the path of these files in your system before
this script can run successfully.</p>
<p>Also note that we need to subtracting energies by the self energies of all
atoms for each molecule. This makes the range of energies in a reasonable
range. The second argument defines how to convert species as a list of string
to tensor, that is, for all supported chemical symbols, which is correspond to
<code class="docutils literal notranslate"><span class="pre">0</span></code>, which correspond to <code class="docutils literal notranslate"><span class="pre">1</span></code>, etc.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">dspath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;../dataset/ani1-up_to_gdb4/ani_gdb_s01.h5&#39;</span><span class="p">)</span>

<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">2560</span>

<span class="n">training</span><span class="p">,</span> <span class="n">validation</span> <span class="o">=</span> <span class="n">torchani</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">load_ani_dataset</span><span class="p">(</span>
    <span class="n">dspath</span><span class="p">,</span> <span class="n">species_to_tensor</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">rm_outlier</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="p">[</span><span class="n">energy_shifter</span><span class="o">.</span><span class="n">subtract_from_dataset</span><span class="p">],</span> <span class="n">split</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Self atomic energies: &#39;</span><span class="p">,</span> <span class="n">energy_shifter</span><span class="o">.</span><span class="n">self_energies</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Self atomic energies:  tensor([-16.1395,  24.0818,  -8.0923, -44.0951], dtype=torch.float64)
</pre></div>
</div>
<dl class="docutils">
<dt>When iterating the dataset, we will get pairs of input and output</dt><dd><p><code class="docutils literal notranslate"><span class="pre">(species_coordinates,</span> <span class="pre">properties)</span></code>, where <code class="docutils literal notranslate"><span class="pre">species_coordinates</span></code> is the
input and <code class="docutils literal notranslate"><span class="pre">properties</span></code> is the output.</p>
<p><code class="docutils literal notranslate"><span class="pre">species_coordinates</span></code> is a list of species-coordinate pairs, with shape
<code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">Na)</span></code> and <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">Na,</span> <span class="pre">3)</span></code>. The reason for getting this type is, when
loading the dataset and generating minibatches, the whole dataset are
shuffled and each minibatch contains structures of molecules with a wide
range of number of atoms. Molecules of different number of atoms are batched
into single by padding. The way padding works is: adding ghost atoms, with
species ‘X’, and do computations as if they were normal atoms. But when
computing AEVs, atoms with species <cite>X</cite> would be ignored. To avoid computation
wasting on padding atoms, minibatches are further splitted into chunks. Each
chunk contains structures of molecules of similar size, which minimize the
total number of padding atoms required to add. The input list
<code class="docutils literal notranslate"><span class="pre">species_coordinates</span></code> contains chunks of that minibatch we are getting. The
batching and chunking happens automatically, so the user does not need to
worry how to construct chunks, but the user need to compute the energies for
each chunk and concat them into single tensor.</p>
<p>The output, i.e. <code class="docutils literal notranslate"><span class="pre">properties</span></code> is a dictionary holding each property. This
allows us to extend TorchANI in the future to training forces and properties.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">H_network</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">384</span><span class="p">,</span> <span class="mi">160</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CELU</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">160</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CELU</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CELU</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">96</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">C_network</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">384</span><span class="p">,</span> <span class="mi">144</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CELU</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">144</span><span class="p">,</span> <span class="mi">112</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CELU</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">112</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CELU</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">96</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">N_network</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">384</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CELU</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">112</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CELU</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">112</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CELU</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">96</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">O_network</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">384</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CELU</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">112</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CELU</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">112</span><span class="p">,</span> <span class="mi">96</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CELU</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">96</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">nn</span> <span class="o">=</span> <span class="n">torchani</span><span class="o">.</span><span class="n">ANIModel</span><span class="p">([</span><span class="n">H_network</span><span class="p">,</span> <span class="n">C_network</span><span class="p">,</span> <span class="n">N_network</span><span class="p">,</span> <span class="n">O_network</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nn</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>ANIModel(
  (0): Sequential(
    (0): Linear(in_features=384, out_features=160, bias=True)
    (1): CELU(alpha=0.1)
    (2): Linear(in_features=160, out_features=128, bias=True)
    (3): CELU(alpha=0.1)
    (4): Linear(in_features=128, out_features=96, bias=True)
    (5): CELU(alpha=0.1)
    (6): Linear(in_features=96, out_features=1, bias=True)
  )
  (1): Sequential(
    (0): Linear(in_features=384, out_features=144, bias=True)
    (1): CELU(alpha=0.1)
    (2): Linear(in_features=144, out_features=112, bias=True)
    (3): CELU(alpha=0.1)
    (4): Linear(in_features=112, out_features=96, bias=True)
    (5): CELU(alpha=0.1)
    (6): Linear(in_features=96, out_features=1, bias=True)
  )
  (2): Sequential(
    (0): Linear(in_features=384, out_features=128, bias=True)
    (1): CELU(alpha=0.1)
    (2): Linear(in_features=128, out_features=112, bias=True)
    (3): CELU(alpha=0.1)
    (4): Linear(in_features=112, out_features=96, bias=True)
    (5): CELU(alpha=0.1)
    (6): Linear(in_features=96, out_features=1, bias=True)
  )
  (3): Sequential(
    (0): Linear(in_features=384, out_features=128, bias=True)
    (1): CELU(alpha=0.1)
    (2): Linear(in_features=128, out_features=112, bias=True)
    (3): CELU(alpha=0.1)
    (4): Linear(in_features=112, out_features=96, bias=True)
    (5): CELU(alpha=0.1)
    (6): Linear(in_features=96, out_features=1, bias=True)
  )
)
</pre></div>
</div>
<p>Initialize the weights and biases.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Pytorch default initialization for the weights and biases in linear layers
is Kaiming uniform. See: <a class="reference external" href="https://pytorch.org/docs/stable/_modules/torch/nn/modules/linear.html#Linear">TORCH.NN.MODULES.LINEAR</a>
We initialize the weights similarly but from the normal distribution.
The biases were initialized to zero.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">init_params</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">):</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">kaiming_normal_</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">zeros_</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">bias</span><span class="p">)</span>


<span class="n">nn</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">init_params</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s now create a pipeline of AEV Computer –&gt; Neural Networks.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">aev_computer</span><span class="p">,</span> <span class="n">nn</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let’s setup the optimizers. NeuroChem uses Adam with decoupled weight decay
to updates the weights and Stochastic Gradient Descent (SGD) to update the biases.
Moreover, we need to specify different weight decay rate for different layes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The weight decay in <a class="reference external" href="https://github.com/aiqm/torchani/blob/master/torchani/resources/ani-1x_8x/inputtrain.ipt">inputtrain.ipt</a> is named “l2”, but it is actually not
L2 regularization. The confusion between L2 and weight decay is a common
mistake in deep learning.  See: <a class="reference external" href="https://arxiv.org/abs/1711.05101">Decoupled Weight Decay Regularization</a>
Also note that the weight decay only applies to weight in the training
of ANI models, not bias.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AdamW</span> <span class="o">=</span> <span class="n">torchani</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">AdamW</span><span class="p">([</span>
    <span class="c1"># H networks</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">H_network</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">H_network</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">],</span> <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.00001</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">H_network</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">],</span> <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.000001</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">H_network</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">]},</span>
    <span class="c1"># C networks</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">C_network</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">C_network</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">],</span> <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.00001</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">C_network</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">],</span> <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.000001</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">C_network</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">]},</span>
    <span class="c1"># N networks</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">N_network</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">N_network</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">],</span> <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.00001</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">N_network</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">],</span> <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.000001</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">N_network</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">]},</span>
    <span class="c1"># O networks</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">O_network</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">O_network</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">],</span> <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.00001</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">O_network</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">],</span> <span class="s1">&#39;weight_decay&#39;</span><span class="p">:</span> <span class="mf">0.000001</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">O_network</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">]},</span>
<span class="p">])</span>

<span class="n">SGD</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">([</span>
    <span class="c1"># H networks</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">H_network</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">H_network</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">H_network</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">H_network</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
    <span class="c1"># C networks</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">C_network</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">C_network</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">C_network</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">C_network</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
    <span class="c1"># N networks</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">N_network</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">N_network</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">N_network</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">N_network</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
    <span class="c1"># O networks</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">O_network</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">O_network</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">O_network</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
    <span class="p">{</span><span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">O_network</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">bias</span><span class="p">]},</span>
<span class="p">],</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>
</div>
<p>Setting up a learning rate scheduler to do learning rate decay</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AdamW_scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">AdamW</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">SGD_scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">SGD</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Train the model by minimizing the MSE loss, until validation RMSE no longer
improves during a certain number of steps, decay the learning rate and repeat
the same process, stop until the learning rate is smaller than a threshold.</p>
<p>We first read the checkpoint files to restart training. We use <cite>latest.pt</cite>
to store current training state.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">latest_checkpoint</span> <span class="o">=</span> <span class="s1">&#39;latest.pt&#39;</span>
</pre></div>
</div>
<p>Resume training from previously saved checkpoints:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">latest_checkpoint</span><span class="p">):</span>
    <span class="n">checkpoint</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">latest_checkpoint</span><span class="p">)</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;nn&#39;</span><span class="p">])</span>
    <span class="n">AdamW</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;AdamW&#39;</span><span class="p">])</span>
    <span class="n">SGD</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;SGD&#39;</span><span class="p">])</span>
    <span class="n">AdamW_scheduler</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;AdamW_scheduler&#39;</span><span class="p">])</span>
    <span class="n">SGD_scheduler</span><span class="o">.</span><span class="n">load_state_dict</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">[</span><span class="s1">&#39;SGD_scheduler&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>During training, we need to validate on validation set and if validation error
is better than the best, then save the new best model to a checkpoint</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># helper function to convert energy unit from Hartree to kcal/mol</span>
<span class="k">def</span> <span class="nf">hartree2kcal</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">627.509</span> <span class="o">*</span> <span class="n">x</span>


<span class="k">def</span> <span class="nf">validate</span><span class="p">():</span>
    <span class="c1"># run validation</span>
    <span class="n">mse_sum</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
    <span class="n">total_mse</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">batch_x</span><span class="p">,</span> <span class="n">batch_y</span> <span class="ow">in</span> <span class="n">validation</span><span class="p">:</span>
        <span class="n">true_energies</span> <span class="o">=</span> <span class="n">batch_y</span><span class="p">[</span><span class="s1">&#39;energies&#39;</span><span class="p">]</span>
        <span class="n">predicted_energies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">chunk_species</span><span class="p">,</span> <span class="n">chunk_coordinates</span> <span class="ow">in</span> <span class="n">batch_x</span><span class="p">:</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">chunk_energies</span> <span class="o">=</span> <span class="n">model</span><span class="p">((</span><span class="n">chunk_species</span><span class="p">,</span> <span class="n">chunk_coordinates</span><span class="p">))</span>
            <span class="n">predicted_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunk_energies</span><span class="p">)</span>
        <span class="n">predicted_energies</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">predicted_energies</span><span class="p">)</span>
        <span class="n">total_mse</span> <span class="o">+=</span> <span class="n">mse_sum</span><span class="p">(</span><span class="n">predicted_energies</span><span class="p">,</span> <span class="n">true_energies</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="n">predicted_energies</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">hartree2kcal</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">total_mse</span> <span class="o">/</span> <span class="n">count</span><span class="p">))</span>
</pre></div>
</div>
<p>We will also use TensorBoard to visualize our training process</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tensorboard</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">tensorboard</span><span class="o">.</span><span class="n">SummaryWriter</span><span class="p">()</span>
</pre></div>
</div>
<p>Finally, we come to the training loop.</p>
<p>In this tutorial, we are setting the maximum epoch to a very small number,
only to make this demo terminate fast. For serious training, this should be
set to a much larger value</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mse</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">(</span><span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;training starting from epoch&quot;</span><span class="p">,</span> <span class="n">AdamW_scheduler</span><span class="o">.</span><span class="n">last_epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">max_epochs</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">early_stopping_learning_rate</span> <span class="o">=</span> <span class="mf">1.0E-5</span>
<span class="n">best_model_checkpoint</span> <span class="o">=</span> <span class="s1">&#39;best.pt&#39;</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">AdamW_scheduler</span><span class="o">.</span><span class="n">last_epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_epochs</span><span class="p">):</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">validate</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RMSE:&#39;</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="s1">&#39;at epoch&#39;</span><span class="p">,</span> <span class="n">AdamW_scheduler</span><span class="o">.</span><span class="n">last_epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">learning_rate</span> <span class="o">=</span> <span class="n">AdamW</span><span class="o">.</span><span class="n">param_groups</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;lr&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">learning_rate</span> <span class="o">&lt;</span> <span class="n">early_stopping_learning_rate</span><span class="p">:</span>
        <span class="k">break</span>

    <span class="c1"># checkpoint</span>
    <span class="k">if</span> <span class="n">AdamW_scheduler</span><span class="o">.</span><span class="n">is_better</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span> <span class="n">AdamW_scheduler</span><span class="o">.</span><span class="n">best</span><span class="p">):</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">best_model_checkpoint</span><span class="p">)</span>

    <span class="n">AdamW_scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>
    <span class="n">SGD_scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">rmse</span><span class="p">)</span>

    <span class="n">tensorboard</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s1">&#39;validation_rmse&#39;</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">AdamW_scheduler</span><span class="o">.</span><span class="n">last_epoch</span><span class="p">)</span>
    <span class="n">tensorboard</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s1">&#39;best_validation_rmse&#39;</span><span class="p">,</span> <span class="n">AdamW_scheduler</span><span class="o">.</span><span class="n">best</span><span class="p">,</span> <span class="n">AdamW_scheduler</span><span class="o">.</span><span class="n">last_epoch</span><span class="p">)</span>
    <span class="n">tensorboard</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">,</span> <span class="n">AdamW_scheduler</span><span class="o">.</span><span class="n">last_epoch</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">batch_x</span><span class="p">,</span> <span class="n">batch_y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span>
        <span class="nb">enumerate</span><span class="p">(</span><span class="n">training</span><span class="p">),</span>
        <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">training</span><span class="p">),</span>
        <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;epoch </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">AdamW_scheduler</span><span class="o">.</span><span class="n">last_epoch</span><span class="p">)</span>
    <span class="p">):</span>

        <span class="n">true_energies</span> <span class="o">=</span> <span class="n">batch_y</span><span class="p">[</span><span class="s1">&#39;energies&#39;</span><span class="p">]</span>
        <span class="n">predicted_energies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">num_atoms</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">chunk_species</span><span class="p">,</span> <span class="n">chunk_coordinates</span> <span class="ow">in</span> <span class="n">batch_x</span><span class="p">:</span>
            <span class="n">num_atoms</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">chunk_species</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">true_energies</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">chunk_energies</span> <span class="o">=</span> <span class="n">model</span><span class="p">((</span><span class="n">chunk_species</span><span class="p">,</span> <span class="n">chunk_coordinates</span><span class="p">))</span>
            <span class="n">predicted_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunk_energies</span><span class="p">)</span>

        <span class="n">num_atoms</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">)</span>
        <span class="n">predicted_energies</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">predicted_energies</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="n">mse</span><span class="p">(</span><span class="n">predicted_energies</span><span class="p">,</span> <span class="n">true_energies</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_atoms</span><span class="o">.</span><span class="n">sqrt</span><span class="p">())</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="n">AdamW</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">SGD</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">AdamW</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
        <span class="n">SGD</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="c1"># write current batch loss to TensorBoard</span>
        <span class="n">tensorboard</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s1">&#39;batch_loss&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="n">AdamW_scheduler</span><span class="o">.</span><span class="n">last_epoch</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">training</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>

    <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">({</span>
        <span class="s1">&#39;nn&#39;</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
        <span class="s1">&#39;AdamW&#39;</span><span class="p">:</span> <span class="n">AdamW</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
        <span class="s1">&#39;SGD&#39;</span><span class="p">:</span> <span class="n">SGD</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
        <span class="s1">&#39;AdamW_scheduler&#39;</span><span class="p">:</span> <span class="n">AdamW_scheduler</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
        <span class="s1">&#39;SGD_scheduler&#39;</span><span class="p">:</span> <span class="n">SGD_scheduler</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span>
    <span class="p">},</span> <span class="n">latest_checkpoint</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>training starting from epoch 0
RMSE: 190.3559355694908 at epoch 0

epoch 0:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 0:  25%|##5       | 1/4 [00:00&lt;00:01,  1.53it/s]
epoch 0:  50%|#####     | 2/4 [00:01&lt;00:01,  1.59it/s]
epoch 0:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.65it/s]
epoch 0: 100%|##########| 4/4 [00:01&lt;00:00,  2.04it/s]
epoch 0: 100%|##########| 4/4 [00:01&lt;00:00,  2.00it/s]
RMSE: 101.45515282224564 at epoch 1

epoch 1:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 1:  25%|##5       | 1/4 [00:00&lt;00:01,  1.85it/s]
epoch 1:  50%|#####     | 2/4 [00:01&lt;00:01,  1.85it/s]
epoch 1:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.85it/s]
epoch 1: 100%|##########| 4/4 [00:01&lt;00:00,  2.26it/s]
epoch 1: 100%|##########| 4/4 [00:01&lt;00:00,  2.18it/s]
RMSE: 44.72020283479298 at epoch 2

epoch 2:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 2:  25%|##5       | 1/4 [00:00&lt;00:01,  1.83it/s]
epoch 2:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 2:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.84it/s]
epoch 2: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 2: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
RMSE: 54.81003696149255 at epoch 3

epoch 3:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 3:  25%|##5       | 1/4 [00:00&lt;00:01,  1.78it/s]
epoch 3:  50%|#####     | 2/4 [00:01&lt;00:01,  1.79it/s]
epoch 3:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 3: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 3: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 59.52821413170898 at epoch 4

epoch 4:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 4:  25%|##5       | 1/4 [00:00&lt;00:01,  1.78it/s]
epoch 4:  50%|#####     | 2/4 [00:01&lt;00:01,  1.79it/s]
epoch 4:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.76it/s]
epoch 4: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
epoch 4: 100%|##########| 4/4 [00:01&lt;00:00,  2.06it/s]
RMSE: 24.499500752751555 at epoch 5

epoch 5:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 5:  25%|##5       | 1/4 [00:00&lt;00:01,  1.83it/s]
epoch 5:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 5:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.80it/s]
epoch 5: 100%|##########| 4/4 [00:01&lt;00:00,  2.18it/s]
epoch 5: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
RMSE: 28.927595536739567 at epoch 6

epoch 6:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 6:  25%|##5       | 1/4 [00:00&lt;00:01,  1.67it/s]
epoch 6:  50%|#####     | 2/4 [00:01&lt;00:01,  1.72it/s]
epoch 6:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.74it/s]
epoch 6: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
epoch 6: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 30.18799012801986 at epoch 7

epoch 7:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 7:  25%|##5       | 1/4 [00:00&lt;00:01,  1.84it/s]
epoch 7:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 7:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 7: 100%|##########| 4/4 [00:01&lt;00:00,  2.21it/s]
epoch 7: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 10.276868383406564 at epoch 8

epoch 8:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 8:  25%|##5       | 1/4 [00:00&lt;00:01,  1.73it/s]
epoch 8:  50%|#####     | 2/4 [00:01&lt;00:01,  1.74it/s]
epoch 8:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 8: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 8: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
RMSE: 15.971277459505998 at epoch 9

epoch 9:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 9:  25%|##5       | 1/4 [00:00&lt;00:01,  1.85it/s]
epoch 9:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 9:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.76it/s]
epoch 9: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 9: 100%|##########| 4/4 [00:01&lt;00:00,  2.05it/s]
RMSE: 17.171388991467886 at epoch 10

epoch 10:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 10:  25%|##5       | 1/4 [00:00&lt;00:01,  1.77it/s]
epoch 10:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 10:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 10: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 10: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
RMSE: 7.376059361362086 at epoch 11

epoch 11:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 11:  25%|##5       | 1/4 [00:00&lt;00:01,  1.78it/s]
epoch 11:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 11:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.83it/s]
epoch 11: 100%|##########| 4/4 [00:01&lt;00:00,  2.21it/s]
epoch 11: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
RMSE: 7.4055716181971665 at epoch 12

epoch 12:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 12:  25%|##5       | 1/4 [00:00&lt;00:01,  1.85it/s]
epoch 12:  50%|#####     | 2/4 [00:01&lt;00:01,  1.84it/s]
epoch 12:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.83it/s]
epoch 12: 100%|##########| 4/4 [00:01&lt;00:00,  2.22it/s]
epoch 12: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
RMSE: 10.123024339326678 at epoch 13

epoch 13:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 13:  25%|##5       | 1/4 [00:00&lt;00:01,  1.73it/s]
epoch 13:  50%|#####     | 2/4 [00:01&lt;00:01,  1.76it/s]
epoch 13:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 13: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 13: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 7.515723635834774 at epoch 14

epoch 14:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 14:  25%|##5       | 1/4 [00:00&lt;00:01,  1.84it/s]
epoch 14:  50%|#####     | 2/4 [00:01&lt;00:01,  1.84it/s]
epoch 14:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.82it/s]
epoch 14: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 14: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 5.188768941458092 at epoch 15

epoch 15:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 15:  25%|##5       | 1/4 [00:00&lt;00:01,  1.76it/s]
epoch 15:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 15:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 15: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 15: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
RMSE: 5.746541661662601 at epoch 16

epoch 16:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 16:  25%|##5       | 1/4 [00:00&lt;00:01,  1.86it/s]
epoch 16:  50%|#####     | 2/4 [00:01&lt;00:01,  1.86it/s]
epoch 16:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.84it/s]
epoch 16: 100%|##########| 4/4 [00:01&lt;00:00,  2.24it/s]
epoch 16: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
RMSE: 5.83837058727812 at epoch 17

epoch 17:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 17:  25%|##5       | 1/4 [00:00&lt;00:01,  1.84it/s]
epoch 17:  50%|#####     | 2/4 [00:01&lt;00:01,  1.83it/s]
epoch 17:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 17: 100%|##########| 4/4 [00:01&lt;00:00,  2.21it/s]
epoch 17: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
RMSE: 5.34461556730487 at epoch 18

epoch 18:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 18:  25%|##5       | 1/4 [00:00&lt;00:01,  1.88it/s]
epoch 18:  50%|#####     | 2/4 [00:01&lt;00:01,  1.88it/s]
epoch 18:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.87it/s]
epoch 18: 100%|##########| 4/4 [00:01&lt;00:00,  2.26it/s]
epoch 18: 100%|##########| 4/4 [00:01&lt;00:00,  2.18it/s]
RMSE: 4.788192873354786 at epoch 19

epoch 19:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 19:  25%|##5       | 1/4 [00:00&lt;00:01,  1.83it/s]
epoch 19:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 19:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.80it/s]
epoch 19: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 19: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 4.674996814511672 at epoch 20

epoch 20:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 20:  25%|##5       | 1/4 [00:00&lt;00:01,  1.81it/s]
epoch 20:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 20:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 20: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 20: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
RMSE: 4.72748123825273 at epoch 21

epoch 21:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 21:  25%|##5       | 1/4 [00:00&lt;00:01,  1.74it/s]
epoch 21:  50%|#####     | 2/4 [00:01&lt;00:01,  1.75it/s]
epoch 21:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 21: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
epoch 21: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 4.5742692868873 at epoch 22

epoch 22:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 22:  25%|##5       | 1/4 [00:00&lt;00:01,  1.76it/s]
epoch 22:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 22:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.80it/s]
epoch 22: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 22: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 4.486958930754976 at epoch 23

epoch 23:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 23:  25%|##5       | 1/4 [00:00&lt;00:01,  1.85it/s]
epoch 23:  50%|#####     | 2/4 [00:01&lt;00:01,  1.83it/s]
epoch 23:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.85it/s]
epoch 23: 100%|##########| 4/4 [00:01&lt;00:00,  2.25it/s]
epoch 23: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
RMSE: 4.362370090440063 at epoch 24

epoch 24:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 24:  25%|##5       | 1/4 [00:00&lt;00:01,  1.88it/s]
epoch 24:  50%|#####     | 2/4 [00:01&lt;00:01,  1.87it/s]
epoch 24:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.87it/s]
epoch 24: 100%|##########| 4/4 [00:01&lt;00:00,  2.26it/s]
epoch 24: 100%|##########| 4/4 [00:01&lt;00:00,  2.18it/s]
RMSE: 4.2928105457855406 at epoch 25

epoch 25:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 25:  25%|##5       | 1/4 [00:00&lt;00:01,  1.78it/s]
epoch 25:  50%|#####     | 2/4 [00:01&lt;00:01,  1.79it/s]
epoch 25:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 25: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
epoch 25: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 4.251471775620237 at epoch 26

epoch 26:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 26:  25%|##5       | 1/4 [00:00&lt;00:01,  1.85it/s]
epoch 26:  50%|#####     | 2/4 [00:01&lt;00:01,  1.85it/s]
epoch 26:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.84it/s]
epoch 26: 100%|##########| 4/4 [00:01&lt;00:00,  2.24it/s]
epoch 26: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
RMSE: 4.189106311346293 at epoch 27

epoch 27:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 27:  25%|##5       | 1/4 [00:00&lt;00:01,  1.85it/s]
epoch 27:  50%|#####     | 2/4 [00:01&lt;00:01,  1.86it/s]
epoch 27:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.87it/s]
epoch 27: 100%|##########| 4/4 [00:01&lt;00:00,  2.28it/s]
epoch 27: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
RMSE: 4.152623984223366 at epoch 28

epoch 28:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 28:  25%|##5       | 1/4 [00:00&lt;00:01,  1.74it/s]
epoch 28:  50%|#####     | 2/4 [00:01&lt;00:01,  1.76it/s]
epoch 28:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 28: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 28: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 4.091692885183771 at epoch 29

epoch 29:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 29:  25%|##5       | 1/4 [00:00&lt;00:01,  1.87it/s]
epoch 29:  50%|#####     | 2/4 [00:01&lt;00:01,  1.87it/s]
epoch 29:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 29: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
epoch 29: 100%|##########| 4/4 [00:01&lt;00:00,  2.05it/s]
RMSE: 4.048132516521747 at epoch 30

epoch 30:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 30:  25%|##5       | 1/4 [00:00&lt;00:01,  1.69it/s]
epoch 30:  50%|#####     | 2/4 [00:01&lt;00:01,  1.72it/s]
epoch 30:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.74it/s]
epoch 30: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
epoch 30: 100%|##########| 4/4 [00:01&lt;00:00,  2.05it/s]
RMSE: 3.9961164666168854 at epoch 31

epoch 31:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 31:  25%|##5       | 1/4 [00:00&lt;00:01,  1.83it/s]
epoch 31:  50%|#####     | 2/4 [00:01&lt;00:01,  1.84it/s]
epoch 31:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.83it/s]
epoch 31: 100%|##########| 4/4 [00:01&lt;00:00,  2.24it/s]
epoch 31: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
RMSE: 3.9514529591371494 at epoch 32

epoch 32:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 32:  25%|##5       | 1/4 [00:00&lt;00:01,  1.86it/s]
epoch 32:  50%|#####     | 2/4 [00:01&lt;00:01,  1.86it/s]
epoch 32:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.85it/s]
epoch 32: 100%|##########| 4/4 [00:01&lt;00:00,  2.23it/s]
epoch 32: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
RMSE: 3.905661584464199 at epoch 33

epoch 33:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 33:  25%|##5       | 1/4 [00:00&lt;00:01,  1.82it/s]
epoch 33:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 33:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.82it/s]
epoch 33: 100%|##########| 4/4 [00:01&lt;00:00,  2.21it/s]
epoch 33: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
RMSE: 3.8623237382371505 at epoch 34

epoch 34:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 34:  25%|##5       | 1/4 [00:00&lt;00:01,  1.92it/s]
epoch 34:  50%|#####     | 2/4 [00:01&lt;00:01,  1.90it/s]
epoch 34:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.88it/s]
epoch 34: 100%|##########| 4/4 [00:01&lt;00:00,  2.28it/s]
epoch 34: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
RMSE: 3.81991197614671 at epoch 35

epoch 35:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 35:  25%|##5       | 1/4 [00:00&lt;00:01,  1.80it/s]
epoch 35:  50%|#####     | 2/4 [00:01&lt;00:01,  1.83it/s]
epoch 35:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.84it/s]
epoch 35: 100%|##########| 4/4 [00:01&lt;00:00,  2.24it/s]
epoch 35: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
RMSE: 3.777913207514882 at epoch 36

epoch 36:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 36:  25%|##5       | 1/4 [00:00&lt;00:01,  1.83it/s]
epoch 36:  50%|#####     | 2/4 [00:01&lt;00:01,  1.85it/s]
epoch 36:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.83it/s]
epoch 36: 100%|##########| 4/4 [00:01&lt;00:00,  2.24it/s]
epoch 36: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
RMSE: 3.73728167027467 at epoch 37

epoch 37:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 37:  25%|##5       | 1/4 [00:00&lt;00:01,  1.83it/s]
epoch 37:  50%|#####     | 2/4 [00:01&lt;00:01,  1.84it/s]
epoch 37:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.83it/s]
epoch 37: 100%|##########| 4/4 [00:01&lt;00:00,  2.22it/s]
epoch 37: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
RMSE: 3.69680445291481 at epoch 38

epoch 38:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 38:  25%|##5       | 1/4 [00:00&lt;00:01,  1.81it/s]
epoch 38:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 38:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 38: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 38: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 3.6575960637138953 at epoch 39

epoch 39:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 39:  25%|##5       | 1/4 [00:00&lt;00:01,  1.84it/s]
epoch 39:  50%|#####     | 2/4 [00:01&lt;00:01,  1.85it/s]
epoch 39:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.82it/s]
epoch 39: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 39: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 3.6185941862022255 at epoch 40

epoch 40:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 40:  25%|##5       | 1/4 [00:00&lt;00:01,  1.78it/s]
epoch 40:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 40:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 40: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 40: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 3.5808277635066377 at epoch 41

epoch 41:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 41:  25%|##5       | 1/4 [00:00&lt;00:01,  1.77it/s]
epoch 41:  50%|#####     | 2/4 [00:01&lt;00:01,  1.77it/s]
epoch 41:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.76it/s]
epoch 41: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 41: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 3.5432362938865434 at epoch 42

epoch 42:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 42:  25%|##5       | 1/4 [00:00&lt;00:01,  1.80it/s]
epoch 42:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 42:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.82it/s]
epoch 42: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 42: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
RMSE: 3.5067434787589384 at epoch 43

epoch 43:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 43:  25%|##5       | 1/4 [00:00&lt;00:01,  1.75it/s]
epoch 43:  50%|#####     | 2/4 [00:01&lt;00:01,  1.73it/s]
epoch 43:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.70it/s]
epoch 43: 100%|##########| 4/4 [00:02&lt;00:00,  2.07it/s]
epoch 43: 100%|##########| 4/4 [00:02&lt;00:00,  1.99it/s]
RMSE: 3.4705813848561338 at epoch 44

epoch 44:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 44:  25%|##5       | 1/4 [00:00&lt;00:01,  1.87it/s]
epoch 44:  50%|#####     | 2/4 [00:01&lt;00:01,  1.83it/s]
epoch 44:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 44: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 44: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
RMSE: 3.4353713573564586 at epoch 45

epoch 45:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 45:  25%|##5       | 1/4 [00:00&lt;00:01,  1.70it/s]
epoch 45:  50%|#####     | 2/4 [00:01&lt;00:01,  1.74it/s]
epoch 45:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.75it/s]
epoch 45: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
epoch 45: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 3.4006081960657015 at epoch 46

epoch 46:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 46:  25%|##5       | 1/4 [00:00&lt;00:01,  1.81it/s]
epoch 46:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 46:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.80it/s]
epoch 46: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 46: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
RMSE: 3.3666816672219793 at epoch 47

epoch 47:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 47:  25%|##5       | 1/4 [00:00&lt;00:01,  1.77it/s]
epoch 47:  50%|#####     | 2/4 [00:01&lt;00:01,  1.77it/s]
epoch 47:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 47: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
epoch 47: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 3.3332741328409696 at epoch 48

epoch 48:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 48:  25%|##5       | 1/4 [00:00&lt;00:01,  1.81it/s]
epoch 48:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 48:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 48: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
epoch 48: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 3.300597856514789 at epoch 49

epoch 49:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 49:  25%|##5       | 1/4 [00:00&lt;00:01,  1.72it/s]
epoch 49:  50%|#####     | 2/4 [00:01&lt;00:01,  1.75it/s]
epoch 49:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.76it/s]
epoch 49: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
epoch 49: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 3.268521122427634 at epoch 50

epoch 50:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 50:  25%|##5       | 1/4 [00:00&lt;00:01,  1.81it/s]
epoch 50:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 50:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 50: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
epoch 50: 100%|##########| 4/4 [00:01&lt;00:00,  2.06it/s]
RMSE: 3.2370849358772174 at epoch 51

epoch 51:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 51:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 51:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 51:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.83it/s]
epoch 51: 100%|##########| 4/4 [00:01&lt;00:00,  2.21it/s]
epoch 51: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
RMSE: 3.206276366366722 at epoch 52

epoch 52:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 52:  25%|##5       | 1/4 [00:00&lt;00:01,  1.78it/s]
epoch 52:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 52:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 52: 100%|##########| 4/4 [00:01&lt;00:00,  2.21it/s]
epoch 52: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
RMSE: 3.176048461704085 at epoch 53

epoch 53:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 53:  25%|##5       | 1/4 [00:00&lt;00:01,  1.71it/s]
epoch 53:  50%|#####     | 2/4 [00:01&lt;00:01,  1.73it/s]
epoch 53:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.76it/s]
epoch 53: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
epoch 53: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 3.146456700281463 at epoch 54

epoch 54:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 54:  25%|##5       | 1/4 [00:00&lt;00:01,  1.80it/s]
epoch 54:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 54:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.80it/s]
epoch 54: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 54: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 3.117411037813606 at epoch 55

epoch 55:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 55:  25%|##5       | 1/4 [00:00&lt;00:01,  1.81it/s]
epoch 55:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 55:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 55: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 55: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 3.0889950341617083 at epoch 56

epoch 56:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 56:  25%|##5       | 1/4 [00:00&lt;00:01,  1.83it/s]
epoch 56:  50%|#####     | 2/4 [00:01&lt;00:01,  1.84it/s]
epoch 56:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.84it/s]
epoch 56: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 56: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
RMSE: 3.061094888479755 at epoch 57

epoch 57:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 57:  25%|##5       | 1/4 [00:00&lt;00:01,  1.78it/s]
epoch 57:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 57:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.80it/s]
epoch 57: 100%|##########| 4/4 [00:01&lt;00:00,  2.18it/s]
epoch 57: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
RMSE: 3.033800943641278 at epoch 58

epoch 58:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 58:  25%|##5       | 1/4 [00:00&lt;00:01,  1.82it/s]
epoch 58:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 58:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.80it/s]
epoch 58: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 58: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 3.007009106968092 at epoch 59

epoch 59:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 59:  25%|##5       | 1/4 [00:00&lt;00:01,  1.82it/s]
epoch 59:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 59:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.80it/s]
epoch 59: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 59: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
RMSE: 2.980788509423414 at epoch 60

epoch 60:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 60:  25%|##5       | 1/4 [00:00&lt;00:01,  1.80it/s]
epoch 60:  50%|#####     | 2/4 [00:01&lt;00:01,  1.79it/s]
epoch 60:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.71it/s]
epoch 60: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
epoch 60: 100%|##########| 4/4 [00:01&lt;00:00,  2.01it/s]
RMSE: 2.9550671429595647 at epoch 61

epoch 61:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 61:  25%|##5       | 1/4 [00:00&lt;00:01,  1.81it/s]
epoch 61:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 61:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.83it/s]
epoch 61: 100%|##########| 4/4 [00:01&lt;00:00,  2.24it/s]
epoch 61: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
RMSE: 2.929870093225513 at epoch 62

epoch 62:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 62:  25%|##5       | 1/4 [00:00&lt;00:01,  1.88it/s]
epoch 62:  50%|#####     | 2/4 [00:01&lt;00:01,  1.87it/s]
epoch 62:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.85it/s]
epoch 62: 100%|##########| 4/4 [00:01&lt;00:00,  2.25it/s]
epoch 62: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
RMSE: 2.9051646009734196 at epoch 63

epoch 63:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 63:  25%|##5       | 1/4 [00:00&lt;00:01,  1.76it/s]
epoch 63:  50%|#####     | 2/4 [00:01&lt;00:01,  1.76it/s]
epoch 63:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 63: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 63: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
RMSE: 2.880946693405787 at epoch 64

epoch 64:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 64:  25%|##5       | 1/4 [00:00&lt;00:01,  1.87it/s]
epoch 64:  50%|#####     | 2/4 [00:01&lt;00:01,  1.86it/s]
epoch 64:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.83it/s]
epoch 64: 100%|##########| 4/4 [00:01&lt;00:00,  2.23it/s]
epoch 64: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
RMSE: 2.857204406083294 at epoch 65

epoch 65:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 65:  25%|##5       | 1/4 [00:00&lt;00:01,  1.81it/s]
epoch 65:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 65:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 65: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 65: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
RMSE: 2.8339159039568584 at epoch 66

epoch 66:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 66:  25%|##5       | 1/4 [00:00&lt;00:01,  1.80it/s]
epoch 66:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 66:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.82it/s]
epoch 66: 100%|##########| 4/4 [00:01&lt;00:00,  2.21it/s]
epoch 66: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
RMSE: 2.8110795403399895 at epoch 67

epoch 67:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 67:  25%|##5       | 1/4 [00:00&lt;00:01,  1.82it/s]
epoch 67:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 67:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.82it/s]
epoch 67: 100%|##########| 4/4 [00:01&lt;00:00,  2.22it/s]
epoch 67: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
RMSE: 2.7886717202461635 at epoch 68

epoch 68:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 68:  25%|##5       | 1/4 [00:00&lt;00:01,  1.80it/s]
epoch 68:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 68:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 68: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 68: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 2.7666870238272896 at epoch 69

epoch 69:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 69:  25%|##5       | 1/4 [00:00&lt;00:01,  1.85it/s]
epoch 69:  50%|#####     | 2/4 [00:01&lt;00:01,  1.83it/s]
epoch 69:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 69: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 69: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 2.745110630465058 at epoch 70

epoch 70:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 70:  25%|##5       | 1/4 [00:00&lt;00:01,  1.78it/s]
epoch 70:  50%|#####     | 2/4 [00:01&lt;00:01,  1.72it/s]
epoch 70:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.72it/s]
epoch 70: 100%|##########| 4/4 [00:02&lt;00:00,  2.07it/s]
epoch 70: 100%|##########| 4/4 [00:02&lt;00:00,  1.97it/s]
RMSE: 2.7239274358042027 at epoch 71

epoch 71:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 71:  25%|##5       | 1/4 [00:00&lt;00:01,  1.69it/s]
epoch 71:  50%|#####     | 2/4 [00:01&lt;00:01,  1.72it/s]
epoch 71:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.75it/s]
epoch 71: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
epoch 71: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 2.7031295998615144 at epoch 72

epoch 72:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 72:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 72:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 72:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 72: 100%|##########| 4/4 [00:01&lt;00:00,  2.21it/s]
epoch 72: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
RMSE: 2.6826991250178347 at epoch 73

epoch 73:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 73:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 73:  50%|#####     | 2/4 [00:01&lt;00:01,  1.79it/s]
epoch 73:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 73: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
epoch 73: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 2.6626280165028064 at epoch 74

epoch 74:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 74:  25%|##5       | 1/4 [00:00&lt;00:01,  1.68it/s]
epoch 74:  50%|#####     | 2/4 [00:01&lt;00:01,  1.72it/s]
epoch 74:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.74it/s]
epoch 74: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
epoch 74: 100%|##########| 4/4 [00:01&lt;00:00,  2.05it/s]
RMSE: 2.642901849345531 at epoch 75

epoch 75:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 75:  25%|##5       | 1/4 [00:00&lt;00:01,  1.86it/s]
epoch 75:  50%|#####     | 2/4 [00:01&lt;00:01,  1.83it/s]
epoch 75:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.82it/s]
epoch 75: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 75: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 2.623511966849523 at epoch 76

epoch 76:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 76:  25%|##5       | 1/4 [00:00&lt;00:01,  1.75it/s]
epoch 76:  50%|#####     | 2/4 [00:01&lt;00:01,  1.74it/s]
epoch 76:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.76it/s]
epoch 76: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
epoch 76: 100%|##########| 4/4 [00:01&lt;00:00,  2.06it/s]
RMSE: 2.604443715789091 at epoch 77

epoch 77:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 77:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 77:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 77:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 77: 100%|##########| 4/4 [00:01&lt;00:00,  2.18it/s]
epoch 77: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
RMSE: 2.585688321768475 at epoch 78

epoch 78:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 78:  25%|##5       | 1/4 [00:00&lt;00:01,  1.83it/s]
epoch 78:  50%|#####     | 2/4 [00:01&lt;00:01,  1.83it/s]
epoch 78:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.83it/s]
epoch 78: 100%|##########| 4/4 [00:01&lt;00:00,  2.22it/s]
epoch 78: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
RMSE: 2.5672329339634383 at epoch 79

epoch 79:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 79:  25%|##5       | 1/4 [00:00&lt;00:01,  1.84it/s]
epoch 79:  50%|#####     | 2/4 [00:01&lt;00:01,  1.83it/s]
epoch 79:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.83it/s]
epoch 79: 100%|##########| 4/4 [00:01&lt;00:00,  2.23it/s]
epoch 79: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
RMSE: 2.549068882702985 at epoch 80

epoch 80:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 80:  25%|##5       | 1/4 [00:00&lt;00:01,  1.81it/s]
epoch 80:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 80:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 80: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
epoch 80: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 2.531185268729004 at epoch 81

epoch 81:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 81:  25%|##5       | 1/4 [00:00&lt;00:01,  1.74it/s]
epoch 81:  50%|#####     | 2/4 [00:01&lt;00:01,  1.79it/s]
epoch 81:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.76it/s]
epoch 81: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
epoch 81: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 2.5135714617073095 at epoch 82

epoch 82:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 82:  25%|##5       | 1/4 [00:00&lt;00:01,  1.77it/s]
epoch 82:  50%|#####     | 2/4 [00:01&lt;00:01,  1.77it/s]
epoch 82:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 82: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 82: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 2.4962179377613287 at epoch 83

epoch 83:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 83:  25%|##5       | 1/4 [00:00&lt;00:01,  1.75it/s]
epoch 83:  50%|#####     | 2/4 [00:01&lt;00:01,  1.75it/s]
epoch 83:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.74it/s]
epoch 83: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
epoch 83: 100%|##########| 4/4 [00:01&lt;00:00,  2.05it/s]
RMSE: 2.479117013821975 at epoch 84

epoch 84:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 84:  25%|##5       | 1/4 [00:00&lt;00:01,  1.78it/s]
epoch 84:  50%|#####     | 2/4 [00:01&lt;00:01,  1.79it/s]
epoch 84:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 84: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 84: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 2.4622607140359416 at epoch 85

epoch 85:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 85:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 85:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 85:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 85: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 85: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 2.445636463499254 at epoch 86

epoch 86:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 86:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 86:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 86:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 86: 100%|##########| 4/4 [00:01&lt;00:00,  2.21it/s]
epoch 86: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
RMSE: 2.429238682489952 at epoch 87

epoch 87:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 87:  25%|##5       | 1/4 [00:00&lt;00:01,  1.65it/s]
epoch 87:  50%|#####     | 2/4 [00:01&lt;00:01,  1.69it/s]
epoch 87:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.72it/s]
epoch 87: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
epoch 87: 100%|##########| 4/4 [00:01&lt;00:00,  2.05it/s]
RMSE: 2.4130600269037648 at epoch 88

epoch 88:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 88:  25%|##5       | 1/4 [00:00&lt;00:01,  1.72it/s]
epoch 88:  50%|#####     | 2/4 [00:01&lt;00:01,  1.76it/s]
epoch 88:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.76it/s]
epoch 88: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
epoch 88: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 2.397093742837703 at epoch 89

epoch 89:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 89:  25%|##5       | 1/4 [00:00&lt;00:01,  1.81it/s]
epoch 89:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 89:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.82it/s]
epoch 89: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 89: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 2.3813303418453255 at epoch 90

epoch 90:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 90:  25%|##5       | 1/4 [00:00&lt;00:01,  1.80it/s]
epoch 90:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 90:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 90: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 90: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 2.365763832294073 at epoch 91

epoch 91:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 91:  25%|##5       | 1/4 [00:00&lt;00:01,  1.74it/s]
epoch 91:  50%|#####     | 2/4 [00:01&lt;00:01,  1.75it/s]
epoch 91:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.76it/s]
epoch 91: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
epoch 91: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 2.350391625061812 at epoch 92

epoch 92:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 92:  25%|##5       | 1/4 [00:00&lt;00:01,  1.78it/s]
epoch 92:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 92:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 92: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 92: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 2.3352030164290625 at epoch 93

epoch 93:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 93:  25%|##5       | 1/4 [00:00&lt;00:01,  1.75it/s]
epoch 93:  50%|#####     | 2/4 [00:01&lt;00:01,  1.76it/s]
epoch 93:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 93: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 93: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 2.3201940750431853 at epoch 94

epoch 94:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 94:  25%|##5       | 1/4 [00:00&lt;00:01,  1.76it/s]
epoch 94:  50%|#####     | 2/4 [00:01&lt;00:01,  1.77it/s]
epoch 94:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 94: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 94: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 2.305361461002574 at epoch 95

epoch 95:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 95:  25%|##5       | 1/4 [00:00&lt;00:01,  1.80it/s]
epoch 95:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 95:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.80it/s]
epoch 95: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 95: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 2.2906977043419205 at epoch 96

epoch 96:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 96:  25%|##5       | 1/4 [00:00&lt;00:01,  1.82it/s]
epoch 96:  50%|#####     | 2/4 [00:01&lt;00:01,  1.83it/s]
epoch 96:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.80it/s]
epoch 96: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 96: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 2.276199206301259 at epoch 97

epoch 97:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 97:  25%|##5       | 1/4 [00:00&lt;00:01,  1.75it/s]
epoch 97:  50%|#####     | 2/4 [00:01&lt;00:01,  1.75it/s]
epoch 97:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.73it/s]
epoch 97: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
epoch 97: 100%|##########| 4/4 [00:01&lt;00:00,  2.02it/s]
RMSE: 2.2618620139081376 at epoch 98

epoch 98:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 98:  25%|##5       | 1/4 [00:00&lt;00:01,  1.82it/s]
epoch 98:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 98:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 98: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 98: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 2.24768082945951 at epoch 99

epoch 99:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 99:  25%|##5       | 1/4 [00:00&lt;00:01,  1.70it/s]
epoch 99:  50%|#####     | 2/4 [00:01&lt;00:01,  1.67it/s]
epoch 99:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.69it/s]
epoch 99: 100%|##########| 4/4 [00:02&lt;00:00,  2.05it/s]
epoch 99: 100%|##########| 4/4 [00:02&lt;00:00,  1.96it/s]
RMSE: 2.2336521635338737 at epoch 100

epoch 100:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 100:  25%|##5       | 1/4 [00:00&lt;00:01,  1.73it/s]
epoch 100:  50%|#####     | 2/4 [00:01&lt;00:01,  1.74it/s]
epoch 100:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.73it/s]
epoch 100: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
epoch 100: 100%|##########| 4/4 [00:01&lt;00:00,  2.04it/s]
RMSE: 2.2197727125168876 at epoch 101

epoch 101:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 101:  25%|##5       | 1/4 [00:00&lt;00:01,  1.71it/s]
epoch 101:  50%|#####     | 2/4 [00:01&lt;00:01,  1.71it/s]
epoch 101:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.73it/s]
epoch 101: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
epoch 101: 100%|##########| 4/4 [00:01&lt;00:00,  2.02it/s]
RMSE: 2.2060391358857157 at epoch 102

epoch 102:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 102:  25%|##5       | 1/4 [00:00&lt;00:01,  1.72it/s]
epoch 102:  50%|#####     | 2/4 [00:01&lt;00:01,  1.72it/s]
epoch 102:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.75it/s]
epoch 102: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
epoch 102: 100%|##########| 4/4 [00:01&lt;00:00,  2.05it/s]
RMSE: 2.19245030300417 at epoch 103

epoch 103:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 103:  25%|##5       | 1/4 [00:00&lt;00:01,  1.75it/s]
epoch 103:  50%|#####     | 2/4 [00:01&lt;00:01,  1.74it/s]
epoch 103:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.72it/s]
epoch 103: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
epoch 103: 100%|##########| 4/4 [00:01&lt;00:00,  2.01it/s]
RMSE: 2.1789990264772237 at epoch 104

epoch 104:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 104:  25%|##5       | 1/4 [00:00&lt;00:01,  1.77it/s]
epoch 104:  50%|#####     | 2/4 [00:01&lt;00:01,  1.79it/s]
epoch 104:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 104: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
epoch 104: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 2.165686144731093 at epoch 105

epoch 105:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 105:  25%|##5       | 1/4 [00:00&lt;00:01,  1.77it/s]
epoch 105:  50%|#####     | 2/4 [00:01&lt;00:01,  1.77it/s]
epoch 105:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.76it/s]
epoch 105: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
epoch 105: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 2.1525084677071398 at epoch 106

epoch 106:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 106:  25%|##5       | 1/4 [00:00&lt;00:01,  1.74it/s]
epoch 106:  50%|#####     | 2/4 [00:01&lt;00:01,  1.74it/s]
epoch 106:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.75it/s]
epoch 106: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
epoch 106: 100%|##########| 4/4 [00:01&lt;00:00,  2.05it/s]
RMSE: 2.1394617484349348 at epoch 107

epoch 107:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 107:  25%|##5       | 1/4 [00:00&lt;00:01,  1.73it/s]
epoch 107:  50%|#####     | 2/4 [00:01&lt;00:01,  1.77it/s]
epoch 107:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 107: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
epoch 107: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 2.126547439197723 at epoch 108

epoch 108:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 108:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 108:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 108:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 108: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 108: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 2.1137607380197156 at epoch 109

epoch 109:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 109:  25%|##5       | 1/4 [00:00&lt;00:01,  1.69it/s]
epoch 109:  50%|#####     | 2/4 [00:01&lt;00:01,  1.69it/s]
epoch 109:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.69it/s]
epoch 109: 100%|##########| 4/4 [00:02&lt;00:00,  2.08it/s]
epoch 109: 100%|##########| 4/4 [00:02&lt;00:00,  2.00it/s]
RMSE: 2.101098075877304 at epoch 110

epoch 110:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 110:  25%|##5       | 1/4 [00:00&lt;00:01,  1.76it/s]
epoch 110:  50%|#####     | 2/4 [00:01&lt;00:01,  1.77it/s]
epoch 110:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 110: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
epoch 110: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 2.0885634972534017 at epoch 111

epoch 111:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 111:  25%|##5       | 1/4 [00:00&lt;00:01,  1.71it/s]
epoch 111:  50%|#####     | 2/4 [00:01&lt;00:01,  1.72it/s]
epoch 111:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.71it/s]
epoch 111: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
epoch 111: 100%|##########| 4/4 [00:01&lt;00:00,  2.02it/s]
RMSE: 2.076149099999446 at epoch 112

epoch 112:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 112:  25%|##5       | 1/4 [00:00&lt;00:01,  1.75it/s]
epoch 112:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 112:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 112: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 112: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 2.063857710948432 at epoch 113

epoch 113:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 113:  25%|##5       | 1/4 [00:00&lt;00:01,  1.75it/s]
epoch 113:  50%|#####     | 2/4 [00:01&lt;00:01,  1.75it/s]
epoch 113:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.75it/s]
epoch 113: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
epoch 113: 100%|##########| 4/4 [00:01&lt;00:00,  2.05it/s]
RMSE: 2.0516863275435595 at epoch 114

epoch 114:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 114:  25%|##5       | 1/4 [00:00&lt;00:01,  1.75it/s]
epoch 114:  50%|#####     | 2/4 [00:01&lt;00:01,  1.73it/s]
epoch 114:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.73it/s]
epoch 114: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
epoch 114: 100%|##########| 4/4 [00:01&lt;00:00,  2.04it/s]
RMSE: 2.039633352345541 at epoch 115

epoch 115:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 115:  25%|##5       | 1/4 [00:00&lt;00:01,  1.75it/s]
epoch 115:  50%|#####     | 2/4 [00:01&lt;00:01,  1.76it/s]
epoch 115:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.74it/s]
epoch 115: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
epoch 115: 100%|##########| 4/4 [00:01&lt;00:00,  2.04it/s]
RMSE: 2.0276966266194645 at epoch 116

epoch 116:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 116:  25%|##5       | 1/4 [00:00&lt;00:01,  1.83it/s]
epoch 116:  50%|#####     | 2/4 [00:01&lt;00:01,  1.84it/s]
epoch 116:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.82it/s]
epoch 116: 100%|##########| 4/4 [00:01&lt;00:00,  2.21it/s]
epoch 116: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
RMSE: 2.0158776258794564 at epoch 117

epoch 117:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 117:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 117:  50%|#####     | 2/4 [00:01&lt;00:01,  1.79it/s]
epoch 117:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 117: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 117: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 2.004173350078159 at epoch 118

epoch 118:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 118:  25%|##5       | 1/4 [00:00&lt;00:01,  1.77it/s]
epoch 118:  50%|#####     | 2/4 [00:01&lt;00:01,  1.76it/s]
epoch 118:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 118: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 118: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 1.9925859912811663 at epoch 119

epoch 119:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 119:  25%|##5       | 1/4 [00:00&lt;00:01,  1.81it/s]
epoch 119:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 119:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 119: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 119: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 1.981109630968865 at epoch 120

epoch 120:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 120:  25%|##5       | 1/4 [00:00&lt;00:01,  1.78it/s]
epoch 120:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 120:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 120: 100%|##########| 4/4 [00:01&lt;00:00,  2.18it/s]
epoch 120: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 1.9697473297974246 at epoch 121

epoch 121:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 121:  25%|##5       | 1/4 [00:00&lt;00:01,  1.72it/s]
epoch 121:  50%|#####     | 2/4 [00:01&lt;00:01,  1.71it/s]
epoch 121:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.71it/s]
epoch 121: 100%|##########| 4/4 [00:02&lt;00:00,  2.04it/s]
epoch 121: 100%|##########| 4/4 [00:02&lt;00:00,  1.97it/s]
RMSE: 1.9584975186802938 at epoch 122

epoch 122:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 122:  25%|##5       | 1/4 [00:00&lt;00:01,  1.74it/s]
epoch 122:  50%|#####     | 2/4 [00:01&lt;00:01,  1.75it/s]
epoch 122:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.76it/s]
epoch 122: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 122: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 1.9473590085196104 at epoch 123

epoch 123:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 123:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 123:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 123:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 123: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 123: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
RMSE: 1.9363319664263543 at epoch 124

epoch 124:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 124:  25%|##5       | 1/4 [00:00&lt;00:01,  1.82it/s]
epoch 124:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 124:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.80it/s]
epoch 124: 100%|##########| 4/4 [00:01&lt;00:00,  2.21it/s]
epoch 124: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 1.9254153095031887 at epoch 125

epoch 125:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 125:  25%|##5       | 1/4 [00:00&lt;00:01,  1.87it/s]
epoch 125:  50%|#####     | 2/4 [00:01&lt;00:01,  1.84it/s]
epoch 125:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.83it/s]
epoch 125: 100%|##########| 4/4 [00:01&lt;00:00,  2.22it/s]
epoch 125: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 1.9146080882891967 at epoch 126

epoch 126:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 126:  25%|##5       | 1/4 [00:00&lt;00:01,  1.78it/s]
epoch 126:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 126:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 126: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 126: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 1.9039096694825348 at epoch 127

epoch 127:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 127:  25%|##5       | 1/4 [00:00&lt;00:01,  1.76it/s]
epoch 127:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 127:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 127: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
epoch 127: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 1.893319565982993 at epoch 128

epoch 128:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 128:  25%|##5       | 1/4 [00:00&lt;00:01,  1.83it/s]
epoch 128:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 128:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.82it/s]
epoch 128: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 128: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 1.882837892188455 at epoch 129

epoch 129:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 129:  25%|##5       | 1/4 [00:00&lt;00:01,  1.75it/s]
epoch 129:  50%|#####     | 2/4 [00:01&lt;00:01,  1.75it/s]
epoch 129:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.76it/s]
epoch 129: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
epoch 129: 100%|##########| 4/4 [00:01&lt;00:00,  2.05it/s]
RMSE: 1.8724642928753963 at epoch 130

epoch 130:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 130:  25%|##5       | 1/4 [00:00&lt;00:01,  1.74it/s]
epoch 130:  50%|#####     | 2/4 [00:01&lt;00:01,  1.73it/s]
epoch 130:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.74it/s]
epoch 130: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
epoch 130: 100%|##########| 4/4 [00:01&lt;00:00,  2.03it/s]
RMSE: 1.862196653782817 at epoch 131

epoch 131:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 131:  25%|##5       | 1/4 [00:00&lt;00:01,  1.82it/s]
epoch 131:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 131:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 131: 100%|##########| 4/4 [00:01&lt;00:00,  2.18it/s]
epoch 131: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
RMSE: 1.8520329786771605 at epoch 132

epoch 132:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 132:  25%|##5       | 1/4 [00:00&lt;00:01,  1.72it/s]
epoch 132:  50%|#####     | 2/4 [00:01&lt;00:01,  1.72it/s]
epoch 132:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.69it/s]
epoch 132: 100%|##########| 4/4 [00:02&lt;00:00,  2.07it/s]
epoch 132: 100%|##########| 4/4 [00:02&lt;00:00,  1.99it/s]
RMSE: 1.8419736981019914 at epoch 133

epoch 133:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 133:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 133:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 133:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.80it/s]
epoch 133: 100%|##########| 4/4 [00:01&lt;00:00,  2.21it/s]
epoch 133: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
RMSE: 1.8320159906791231 at epoch 134

epoch 134:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 134:  25%|##5       | 1/4 [00:00&lt;00:01,  1.80it/s]
epoch 134:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 134:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 134: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 134: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 1.8221571424028666 at epoch 135

epoch 135:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 135:  25%|##5       | 1/4 [00:00&lt;00:01,  1.81it/s]
epoch 135:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 135:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 135: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 135: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 1.8123938953511958 at epoch 136

epoch 136:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 136:  25%|##5       | 1/4 [00:00&lt;00:01,  1.71it/s]
epoch 136:  50%|#####     | 2/4 [00:01&lt;00:01,  1.72it/s]
epoch 136:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.75it/s]
epoch 136: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
epoch 136: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 1.8027204567895925 at epoch 137

epoch 137:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 137:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 137:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 137:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 137: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 137: 100%|##########| 4/4 [00:01&lt;00:00,  2.06it/s]
RMSE: 1.7931338300758537 at epoch 138

epoch 138:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 138:  25%|##5       | 1/4 [00:00&lt;00:01,  1.67it/s]
epoch 138:  50%|#####     | 2/4 [00:01&lt;00:01,  1.69it/s]
epoch 138:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.70it/s]
epoch 138: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
epoch 138: 100%|##########| 4/4 [00:01&lt;00:00,  2.01it/s]
RMSE: 1.7836264673377726 at epoch 139

epoch 139:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 139:  25%|##5       | 1/4 [00:00&lt;00:01,  1.76it/s]
epoch 139:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 139:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 139: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
epoch 139: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 1.7741935184120317 at epoch 140

epoch 140:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 140:  25%|##5       | 1/4 [00:00&lt;00:01,  1.58it/s]
epoch 140:  50%|#####     | 2/4 [00:01&lt;00:01,  1.64it/s]
epoch 140:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.68it/s]
epoch 140: 100%|##########| 4/4 [00:01&lt;00:00,  2.05it/s]
epoch 140: 100%|##########| 4/4 [00:01&lt;00:00,  2.01it/s]
RMSE: 1.7648268449404432 at epoch 141

epoch 141:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 141:  25%|##5       | 1/4 [00:00&lt;00:01,  1.74it/s]
epoch 141:  50%|#####     | 2/4 [00:01&lt;00:01,  1.76it/s]
epoch 141:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 141: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
epoch 141: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 1.7555219951967842 at epoch 142

epoch 142:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 142:  25%|##5       | 1/4 [00:00&lt;00:01,  1.68it/s]
epoch 142:  50%|#####     | 2/4 [00:01&lt;00:01,  1.71it/s]
epoch 142:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.74it/s]
epoch 142: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
epoch 142: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 1.746277235175482 at epoch 143

epoch 143:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 143:  25%|##5       | 1/4 [00:00&lt;00:01,  1.85it/s]
epoch 143:  50%|#####     | 2/4 [00:01&lt;00:01,  1.83it/s]
epoch 143:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 143: 100%|##########| 4/4 [00:01&lt;00:00,  2.21it/s]
epoch 143: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 1.7370967496123322 at epoch 144

epoch 144:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 144:  25%|##5       | 1/4 [00:00&lt;00:01,  1.83it/s]
epoch 144:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 144:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 144: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
epoch 144: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 1.7279851983155963 at epoch 145

epoch 145:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 145:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 145:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 145:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 145: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 145: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
RMSE: 1.7189669870190802 at epoch 146

epoch 146:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 146:  25%|##5       | 1/4 [00:00&lt;00:01,  1.77it/s]
epoch 146:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 146:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 146: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
epoch 146: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 1.710072682411925 at epoch 147

epoch 147:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 147:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 147:  50%|#####     | 2/4 [00:01&lt;00:01,  1.79it/s]
epoch 147:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.80it/s]
epoch 147: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 147: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 1.7013464401500251 at epoch 148

epoch 148:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 148:  25%|##5       | 1/4 [00:00&lt;00:01,  1.87it/s]
epoch 148:  50%|#####     | 2/4 [00:01&lt;00:01,  1.87it/s]
epoch 148:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.84it/s]
epoch 148: 100%|##########| 4/4 [00:01&lt;00:00,  2.24it/s]
epoch 148: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
RMSE: 1.6928468234542278 at epoch 149

epoch 149:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 149:  25%|##5       | 1/4 [00:00&lt;00:01,  1.82it/s]
epoch 149:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 149:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 149: 100%|##########| 4/4 [00:01&lt;00:00,  2.18it/s]
epoch 149: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 1.6846427715742005 at epoch 150

epoch 150:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 150:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 150:  50%|#####     | 2/4 [00:01&lt;00:01,  1.79it/s]
epoch 150:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.80it/s]
epoch 150: 100%|##########| 4/4 [00:01&lt;00:00,  2.18it/s]
epoch 150: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 1.6768051975128686 at epoch 151

epoch 151:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 151:  25%|##5       | 1/4 [00:00&lt;00:01,  1.87it/s]
epoch 151:  50%|#####     | 2/4 [00:01&lt;00:01,  1.88it/s]
epoch 151:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.86it/s]
epoch 151: 100%|##########| 4/4 [00:01&lt;00:00,  2.24it/s]
epoch 151: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
RMSE: 1.6693964711367477 at epoch 152

epoch 152:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 152:  25%|##5       | 1/4 [00:00&lt;00:01,  1.75it/s]
epoch 152:  50%|#####     | 2/4 [00:01&lt;00:01,  1.77it/s]
epoch 152:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 152: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 152: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 1.6624587853493829 at epoch 153

epoch 153:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 153:  25%|##5       | 1/4 [00:00&lt;00:01,  1.72it/s]
epoch 153:  50%|#####     | 2/4 [00:01&lt;00:01,  1.73it/s]
epoch 153:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.73it/s]
epoch 153: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
epoch 153: 100%|##########| 4/4 [00:01&lt;00:00,  2.05it/s]
RMSE: 1.6560020587739754 at epoch 154

epoch 154:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 154:  25%|##5       | 1/4 [00:00&lt;00:01,  1.67it/s]
epoch 154:  50%|#####     | 2/4 [00:01&lt;00:01,  1.68it/s]
epoch 154:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.71it/s]
epoch 154: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
epoch 154: 100%|##########| 4/4 [00:01&lt;00:00,  2.03it/s]
RMSE: 1.6499819298425598 at epoch 155

epoch 155:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 155:  25%|##5       | 1/4 [00:00&lt;00:01,  1.74it/s]
epoch 155:  50%|#####     | 2/4 [00:01&lt;00:01,  1.76it/s]
epoch 155:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.76it/s]
epoch 155: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 155: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 1.6443085649724531 at epoch 156

epoch 156:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 156:  25%|##5       | 1/4 [00:00&lt;00:01,  1.66it/s]
epoch 156:  50%|#####     | 2/4 [00:01&lt;00:01,  1.68it/s]
epoch 156:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.72it/s]
epoch 156: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
epoch 156: 100%|##########| 4/4 [00:01&lt;00:00,  2.04it/s]
RMSE: 1.6388404313606684 at epoch 157

epoch 157:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 157:  25%|##5       | 1/4 [00:00&lt;00:01,  1.77it/s]
epoch 157:  50%|#####     | 2/4 [00:01&lt;00:01,  1.74it/s]
epoch 157:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.73it/s]
epoch 157: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
epoch 157: 100%|##########| 4/4 [00:01&lt;00:00,  2.02it/s]
RMSE: 1.633394425989154 at epoch 158

epoch 158:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 158:  25%|##5       | 1/4 [00:00&lt;00:01,  1.77it/s]
epoch 158:  50%|#####     | 2/4 [00:01&lt;00:01,  1.77it/s]
epoch 158:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 158: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
epoch 158: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 1.6277677591798152 at epoch 159

epoch 159:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 159:  25%|##5       | 1/4 [00:00&lt;00:01,  1.68it/s]
epoch 159:  50%|#####     | 2/4 [00:01&lt;00:01,  1.70it/s]
epoch 159:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.73it/s]
epoch 159: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
epoch 159: 100%|##########| 4/4 [00:01&lt;00:00,  2.06it/s]
RMSE: 1.6217693381024194 at epoch 160

epoch 160:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 160:  25%|##5       | 1/4 [00:00&lt;00:01,  1.77it/s]
epoch 160:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 160:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 160: 100%|##########| 4/4 [00:01&lt;00:00,  2.21it/s]
epoch 160: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
RMSE: 1.615243143141763 at epoch 161

epoch 161:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 161:  25%|##5       | 1/4 [00:00&lt;00:01,  1.76it/s]
epoch 161:  50%|#####     | 2/4 [00:01&lt;00:01,  1.77it/s]
epoch 161:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 161: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 161: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 1.6081039371859016 at epoch 162

epoch 162:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 162:  25%|##5       | 1/4 [00:00&lt;00:01,  1.84it/s]
epoch 162:  50%|#####     | 2/4 [00:01&lt;00:01,  1.83it/s]
epoch 162:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 162: 100%|##########| 4/4 [00:01&lt;00:00,  2.21it/s]
epoch 162: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 1.6003460093504285 at epoch 163

epoch 163:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 163:  25%|##5       | 1/4 [00:00&lt;00:01,  1.80it/s]
epoch 163:  50%|#####     | 2/4 [00:01&lt;00:01,  1.79it/s]
epoch 163:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 163: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 163: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 1.5920599206342732 at epoch 164

epoch 164:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 164:  25%|##5       | 1/4 [00:00&lt;00:01,  1.86it/s]
epoch 164:  50%|#####     | 2/4 [00:01&lt;00:01,  1.84it/s]
epoch 164:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.82it/s]
epoch 164: 100%|##########| 4/4 [00:01&lt;00:00,  2.18it/s]
epoch 164: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
RMSE: 1.583406158787277 at epoch 165

epoch 165:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 165:  25%|##5       | 1/4 [00:00&lt;00:01,  1.82it/s]
epoch 165:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 165:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 165: 100%|##########| 4/4 [00:01&lt;00:00,  2.18it/s]
epoch 165: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 1.5746073175954685 at epoch 166

epoch 166:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 166:  25%|##5       | 1/4 [00:00&lt;00:01,  1.68it/s]
epoch 166:  50%|#####     | 2/4 [00:01&lt;00:01,  1.70it/s]
epoch 166:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.73it/s]
epoch 166: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
epoch 166: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 1.5658882785398391 at epoch 167

epoch 167:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 167:  25%|##5       | 1/4 [00:00&lt;00:01,  1.68it/s]
epoch 167:  50%|#####     | 2/4 [00:01&lt;00:01,  1.70it/s]
epoch 167:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.73it/s]
epoch 167: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
epoch 167: 100%|##########| 4/4 [00:01&lt;00:00,  2.05it/s]
RMSE: 1.557458007167268 at epoch 168

epoch 168:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 168:  25%|##5       | 1/4 [00:00&lt;00:01,  1.76it/s]
epoch 168:  50%|#####     | 2/4 [00:01&lt;00:01,  1.76it/s]
epoch 168:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 168: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 168: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 1.5494602175976582 at epoch 169

epoch 169:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 169:  25%|##5       | 1/4 [00:00&lt;00:01,  1.77it/s]
epoch 169:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 169:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 169: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 169: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
RMSE: 1.5419653924418522 at epoch 170

epoch 170:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 170:  25%|##5       | 1/4 [00:00&lt;00:01,  1.80it/s]
epoch 170:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 170:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.80it/s]
epoch 170: 100%|##########| 4/4 [00:01&lt;00:00,  2.18it/s]
epoch 170: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 1.5349802908253107 at epoch 171

epoch 171:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 171:  25%|##5       | 1/4 [00:00&lt;00:01,  1.75it/s]
epoch 171:  50%|#####     | 2/4 [00:01&lt;00:01,  1.73it/s]
epoch 171:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.70it/s]
epoch 171: 100%|##########| 4/4 [00:02&lt;00:00,  2.05it/s]
epoch 171: 100%|##########| 4/4 [00:02&lt;00:00,  1.97it/s]
RMSE: 1.5284632491226993 at epoch 172

epoch 172:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 172:  25%|##5       | 1/4 [00:00&lt;00:01,  1.71it/s]
epoch 172:  50%|#####     | 2/4 [00:01&lt;00:01,  1.74it/s]
epoch 172:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.76it/s]
epoch 172: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
epoch 172: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 1.5223441083480662 at epoch 173

epoch 173:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 173:  25%|##5       | 1/4 [00:00&lt;00:01,  1.70it/s]
epoch 173:  50%|#####     | 2/4 [00:01&lt;00:01,  1.72it/s]
epoch 173:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.74it/s]
epoch 173: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
epoch 173: 100%|##########| 4/4 [00:01&lt;00:00,  2.06it/s]
RMSE: 1.5165446187788032 at epoch 174

epoch 174:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 174:  25%|##5       | 1/4 [00:00&lt;00:01,  1.85it/s]
epoch 174:  50%|#####     | 2/4 [00:01&lt;00:01,  1.84it/s]
epoch 174:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.83it/s]
epoch 174: 100%|##########| 4/4 [00:01&lt;00:00,  2.22it/s]
epoch 174: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
RMSE: 1.510994584011717 at epoch 175

epoch 175:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 175:  25%|##5       | 1/4 [00:00&lt;00:01,  1.73it/s]
epoch 175:  50%|#####     | 2/4 [00:01&lt;00:01,  1.75it/s]
epoch 175:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.73it/s]
epoch 175: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
epoch 175: 100%|##########| 4/4 [00:01&lt;00:00,  2.05it/s]
RMSE: 1.5056550413646033 at epoch 176

epoch 176:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 176:  25%|##5       | 1/4 [00:00&lt;00:01,  1.69it/s]
epoch 176:  50%|#####     | 2/4 [00:01&lt;00:01,  1.72it/s]
epoch 176:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.75it/s]
epoch 176: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
epoch 176: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 1.5005247869309575 at epoch 177

epoch 177:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 177:  25%|##5       | 1/4 [00:00&lt;00:01,  1.75it/s]
epoch 177:  50%|#####     | 2/4 [00:01&lt;00:01,  1.76it/s]
epoch 177:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 177: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 177: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 1.4956480894341497 at epoch 178

epoch 178:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 178:  25%|##5       | 1/4 [00:00&lt;00:01,  1.78it/s]
epoch 178:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 178:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 178: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 178: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
RMSE: 1.4910869315010595 at epoch 179

epoch 179:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 179:  25%|##5       | 1/4 [00:00&lt;00:01,  1.74it/s]
epoch 179:  50%|#####     | 2/4 [00:01&lt;00:01,  1.75it/s]
epoch 179:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.74it/s]
epoch 179: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
epoch 179: 100%|##########| 4/4 [00:01&lt;00:00,  2.04it/s]
RMSE: 1.4868957720862213 at epoch 180

epoch 180:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 180:  25%|##5       | 1/4 [00:00&lt;00:01,  1.77it/s]
epoch 180:  50%|#####     | 2/4 [00:01&lt;00:01,  1.76it/s]
epoch 180:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 180: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
epoch 180: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 1.483095492024629 at epoch 181

epoch 181:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 181:  25%|##5       | 1/4 [00:00&lt;00:01,  1.77it/s]
epoch 181:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 181:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.76it/s]
epoch 181: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
epoch 181: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 1.4796848002354244 at epoch 182

epoch 182:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 182:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 182:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 182:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 182: 100%|##########| 4/4 [00:01&lt;00:00,  2.16it/s]
epoch 182: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 1.4766617972328857 at epoch 183

epoch 183:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 183:  25%|##5       | 1/4 [00:00&lt;00:01,  1.83it/s]
epoch 183:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 183:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 183: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 183: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 1.4740123397406681 at epoch 184

epoch 184:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 184:  25%|##5       | 1/4 [00:00&lt;00:01,  1.81it/s]
epoch 184:  50%|#####     | 2/4 [00:01&lt;00:01,  1.81it/s]
epoch 184:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 184: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 184: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 1.4717385605159887 at epoch 185

epoch 185:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 185:  25%|##5       | 1/4 [00:00&lt;00:01,  1.81it/s]
epoch 185:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 185:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 185: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
epoch 185: 100%|##########| 4/4 [00:01&lt;00:00,  2.03it/s]
RMSE: 1.4698364853281445 at epoch 186

epoch 186:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 186:  25%|##5       | 1/4 [00:00&lt;00:01,  1.78it/s]
epoch 186:  50%|#####     | 2/4 [00:01&lt;00:01,  1.76it/s]
epoch 186:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.74it/s]
epoch 186: 100%|##########| 4/4 [00:01&lt;00:00,  2.10it/s]
epoch 186: 100%|##########| 4/4 [00:01&lt;00:00,  2.02it/s]
RMSE: 1.4682897516403488 at epoch 187

epoch 187:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 187:  25%|##5       | 1/4 [00:00&lt;00:01,  1.69it/s]
epoch 187:  50%|#####     | 2/4 [00:01&lt;00:01,  1.72it/s]
epoch 187:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.74it/s]
epoch 187: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
epoch 187: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 1.467060309947071 at epoch 188

epoch 188:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 188:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 188:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 188:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.77it/s]
epoch 188: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 188: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 1.466076465913433 at epoch 189

epoch 189:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 189:  25%|##5       | 1/4 [00:00&lt;00:01,  1.80it/s]
epoch 189:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 189:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 189: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 189: 100%|##########| 4/4 [00:01&lt;00:00,  2.11it/s]
RMSE: 1.4652452669871372 at epoch 190

epoch 190:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 190:  25%|##5       | 1/4 [00:00&lt;00:01,  1.71it/s]
epoch 190:  50%|#####     | 2/4 [00:01&lt;00:01,  1.74it/s]
epoch 190:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.75it/s]
epoch 190: 100%|##########| 4/4 [00:01&lt;00:00,  2.14it/s]
epoch 190: 100%|##########| 4/4 [00:01&lt;00:00,  2.08it/s]
RMSE: 1.4644543476077923 at epoch 191

epoch 191:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 191:  25%|##5       | 1/4 [00:00&lt;00:01,  1.79it/s]
epoch 191:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 191:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 191: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 191: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 1.4635666625054462 at epoch 192

epoch 192:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 192:  25%|##5       | 1/4 [00:00&lt;00:01,  1.80it/s]
epoch 192:  50%|#####     | 2/4 [00:01&lt;00:01,  1.82it/s]
epoch 192:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.82it/s]
epoch 192: 100%|##########| 4/4 [00:01&lt;00:00,  2.19it/s]
epoch 192: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 1.4624225296909261 at epoch 193

epoch 193:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 193:  25%|##5       | 1/4 [00:00&lt;00:01,  1.80it/s]
epoch 193:  50%|#####     | 2/4 [00:01&lt;00:01,  1.80it/s]
epoch 193:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.81it/s]
epoch 193: 100%|##########| 4/4 [00:01&lt;00:00,  2.20it/s]
epoch 193: 100%|##########| 4/4 [00:01&lt;00:00,  2.12it/s]
RMSE: 1.4608331965464731 at epoch 194

epoch 194:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 194:  25%|##5       | 1/4 [00:00&lt;00:01,  1.78it/s]
epoch 194:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 194:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.78it/s]
epoch 194: 100%|##########| 4/4 [00:01&lt;00:00,  2.17it/s]
epoch 194: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
RMSE: 1.4586039403733269 at epoch 195

epoch 195:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 195:  25%|##5       | 1/4 [00:00&lt;00:01,  1.59it/s]
epoch 195:  50%|#####     | 2/4 [00:01&lt;00:01,  1.63it/s]
epoch 195:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.65it/s]
epoch 195: 100%|##########| 4/4 [00:02&lt;00:00,  2.02it/s]
epoch 195: 100%|##########| 4/4 [00:02&lt;00:00,  1.97it/s]
RMSE: 1.4555289901079311 at epoch 196

epoch 196:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 196:  25%|##5       | 1/4 [00:00&lt;00:01,  1.76it/s]
epoch 196:  50%|#####     | 2/4 [00:01&lt;00:01,  1.77it/s]
epoch 196:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.75it/s]
epoch 196: 100%|##########| 4/4 [00:01&lt;00:00,  2.15it/s]
epoch 196: 100%|##########| 4/4 [00:01&lt;00:00,  2.07it/s]
RMSE: 1.451420560386076 at epoch 197

epoch 197:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 197:  25%|##5       | 1/4 [00:00&lt;00:01,  1.72it/s]
epoch 197:  50%|#####     | 2/4 [00:01&lt;00:01,  1.73it/s]
epoch 197:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.75it/s]
epoch 197: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
epoch 197: 100%|##########| 4/4 [00:01&lt;00:00,  2.03it/s]
RMSE: 1.4461046644031474 at epoch 198

epoch 198:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 198:  25%|##5       | 1/4 [00:00&lt;00:01,  1.72it/s]
epoch 198:  50%|#####     | 2/4 [00:01&lt;00:01,  1.74it/s]
epoch 198:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.73it/s]
epoch 198: 100%|##########| 4/4 [00:01&lt;00:00,  2.13it/s]
epoch 198: 100%|##########| 4/4 [00:01&lt;00:00,  2.06it/s]
RMSE: 1.4394536981965789 at epoch 199

epoch 199:   0%|          | 0/4 [00:00&lt;?, ?it/s]
epoch 199:  25%|##5       | 1/4 [00:00&lt;00:01,  1.81it/s]
epoch 199:  50%|#####     | 2/4 [00:01&lt;00:01,  1.78it/s]
epoch 199:  75%|#######5  | 3/4 [00:01&lt;00:00,  1.79it/s]
epoch 199: 100%|##########| 4/4 [00:01&lt;00:00,  2.18it/s]
epoch 199: 100%|##########| 4/4 [00:01&lt;00:00,  2.09it/s]
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 7 minutes  19.706 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-nnp-training-py">
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/1a1c456fc1c08da39ec892b2971889ce/nnp_training.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">nnp_training.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal" download="" href="../_downloads/0e3165127c19b92b139f001b08045e43/nnp_training.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">nnp_training.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="nnp_training_force.html" class="btn btn-neutral float-right" title="Train Neural Network Potential To Both Energies and Forces" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="load_from_neurochem.html" class="btn btn-neutral float-left" title="Construct Model From NeuroChem Files" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Roitberg Group

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>